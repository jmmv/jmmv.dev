<!doctype html><html lang=en xmlns=http://www.w3.org/1999/xhtml xmlns:fb=http://ogp.me/ns/fb#>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta property="og:site_name" content="Julio Merino (jmmv.dev)">
<meta property="twitter:site" content="@jmmv">
<title>Should the browser use all available memory? - Julio Merino (jmmv.dev)</title>
<meta property="og:title" content="Should the browser use all available memory? - Julio Merino (jmmv.dev)">
<meta property="twitter:title" content="Should the browser use all available memory? - Julio Merino (jmmv.dev)">
<meta name=description content="We have all seen discussions go like this: someone first complains that an application like Google Chrome is wasteful because it uses multiple GBs of memory. Someone else comes along and says that memory is there to be used for speed and therefore this is the correct behavior: if the computer has multiple GBs of free memory, an application such as Chrome should make use of all the available memory in the form of a cache to be as responsive as possible. Makes sense, right? Yes, it does makes sense&amp;mdash;as long as Chrome is the only application running. Let&amp;rsquo;s explore why this is not a great idea.">
<meta property="og:description" content="We have all seen discussions go like this: someone first complains that an application like Google Chrome is wasteful because it uses multiple GBs of memory. Someone else comes along and says that memory is there to be used for speed and therefore this is the correct behavior: if the computer has multiple GBs of free memory, an application such as Chrome should make use of all the available memory in the form of a cache to be as responsive as possible. Makes sense, right? Yes, it does makes sense&amp;mdash;as long as Chrome is the only application running. Let&amp;rsquo;s explore why this is not a great idea.">
<meta property="twitter:description" content="We have all seen discussions go like this: someone first complains that an application like Google Chrome is wasteful because it uses multiple GBs of memory. Someone else comes along and says that …">
<meta name=author content="Julio Merino">
<meta property="twitter:creator" content="@jmmv">
<meta name=generator content="Hugo 0.92.1">
<meta property="og:url" content="https://jmmv.dev/2021/08/using-all-memory-as-a-cache.html">
<meta property="og:type" content="blog">
<meta property="twitter:card" content="summary">
<link rel=canonical href=https://jmmv.dev/2021/08/using-all-memory-as-a-cache.html>
<link rel=alternate type=application/rss+xml title="Julio Merino (jmmv.dev)" href=/feed.xml>
<link rel=stylesheet href=/sass/main.min.e6bc80a1be92c773c7961a8e97099442cea2dd8ed61958e61cf1436928d991e2.css>
<link rel=stylesheet href=/css/chroma.css>
<meta property="og:image" content="/images/favicons/favicon-1200x1200.png">
<link rel=icon type=image/png href=/images/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/images/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/images/favicons/favicon-96x96.png sizes=96x96>
<meta property="twitter:image" content="https://jmmv.dev/images/favicons/favicon-1200x1200.png">
<script>const SITE_ID='e8da9f62-b7ac-4fe9-bf20-7c527199a376',BASE_URL='https://jmmv.dev/'</script>
</head>
<body>
<header class=site-header>
<nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-primary">
<a class=navbar-brand href=/>
<img src=/images/favicons/favicon-30x30.png width=30 height=30 class="d-inline-block align-top" alt>
&nbsp;Julio Merino
</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav mr-auto">
<li class=nav-item>
<a class=nav-link href=/about.html>About</a>
</li>
<li class=nav-item>
<a class=nav-link href=/essays.html>Essays</a>
</li>
<li class=nav-item>
<a class=nav-link href=/resume.html>Resume</a>
</li>
<li class=nav-item>
<a class=nav-link href=/software.html>Software</a>
</li>
</ul>
<ul class="navbar-nav mr-4">
<li class=nav-item>
<a class=nav-link href=/archive.html>Archive</a>
</li>
<li class=nav-item>
<a class=nav-link href=/series.html>Series</a>
</li>
<li class=nav-item>
<a class=nav-link href=/tags.html>Tags</a>
</li>
</ul>
<form class=form-inline method=get role=search action=https://www.google.com/search>
<div class=input-group>
<input type=search name=query class=form-control placeholder=Search aria-label=Search>
<div class=input-group-append>
<button type=submit value=Search class="btn btn-light">
<img src=/octicons/search.svg>
</button>
</div>
</div>
<input type=hidden name=sitesearch value=https://jmmv.dev/>
</form>
</div>
</nav>
</header>
<div class=page-header>
<div class=container>
<h1>Should the browser use all available memory?</h1>
<p>August 12, 2021 &#183;
About 13 minutes
&#183;
Tags:
<a class=text-reset href=/tags/opinion>opinion</a>, <a class=text-reset href=/tags/programming>programming</a></p>
</div>
</div>
<div class=container>
<div class=row>
<div class=col-md-9>
<div class=row>
<div class=col>
<article><p><em>This post has been sitting in my drafts folder for exactly three years now. Part of my hesitation in posting it is that what follows is a difficult idea to communicate. But another part is that this is likely to be controversial, if only due to the provocative title. In any case, the time has come to set this piece free!</em></p>
<hr>
<p><a href=https://en.wikipedia.org/wiki/Betteridge%27s_law_of_headlines>Betteridge&rsquo;s law of headlines</a> says that the answer to the question in the title is &ldquo;No&rdquo;, and&mldr; I concur&mldr; with some caveats.</p>
<p>We have all seen discussions go like this, especially on Hacker News: someone first complains that an application like Google Chrome is wasteful because it uses multiple GBs of memory. Someone else comes along and says that memory is there to be used for speed and therefore this is the correct behavior: if the computer has multiple GBs of free memory, an application such as Chrome should make use of all the available memory in the form of a cache to be as responsive as possible. Makes sense, right?</p>
<p>Yes, it does makes sense&mdash;<em>as long as Chrome is the only application running</em>. But that&rsquo;s not what usually happens, is it? There are always multiple programs running at once (think system services, but also heavyweight programs like Teams) which means that this is probably not the greatest idea.</p>
<p>In this post, I want to explore why allowing applications to consume all available memory for their caching needs is suboptimal and what solutions might exist to that problem. I&rsquo;ll pick on Chrome because that&rsquo;s the common target of this complaint, but this applies equally to all other browsers and most modern &ldquo;bloated&rdquo; programs. But, before that, let&rsquo;s review some memory management basics to ensure we are all on the same <em>page</em>.</p>
<h1 id=a-recap-on-memory-paging>A recap on memory paging</h1>
<p>Modern computers offer an essentially-unlimited memory address space to each application (process) running on the computer. Each process thinks it&rsquo;s running alone and that a vast amount of memory, from address zero to address 2^64 on 64-bit machines, is available for its own consumption.</p>
<p>Which is obviously not true: there is no computer (yet) with 2^64 physical bytes (16 exabytes) of RAM&mdash;it&rsquo;s only <em><a href=http://arresteddevelopment.wikia.com/wiki/G.O.B.%27s_illusions>an illusion, Michael</a></em>. Computer processors divide physical memory into fixed-size <em>page frames</em> (traditionally 4 KBs) and divide the virtual memory of each process into <em>pages</em>. The operating system kernel is then in charge of mapping a subset of the virtual memory pages onto the physical page frames, and the processor handles the translation between virtual and physical addresses transparently for each memory access.</p>
<p>Under this design, the virtual address space is much larger than the physical memory and there can be multiple processes (and thus multiple virtual address spaces) running at once. In other words: physical memory is intentionally <em>over-committed</em>. When a process allocates more memory in its virtual address space, there might not be any available physical pages to back the newly-allocated virtual pages. At that point we hit a condition known as <em>memory pressure</em> and the kernel will have to do <em>something</em> to mitigate it in an attempt to fulfill the new memory request.</p>
<p>What the kernel does under memory pressure is specific to each operating system, but in the general case, the kernel must find already-mapped pages (from <em>any</em> process) and evict them in order to free page frames to make room for the new memory requests.</p>
<p>We can classify pages in the following two groups. I suggest reading the paper on <a href=https://www.usenix.org/conference/2000-usenix-annual-technical-conference/ubc-efficient-unified-io-and-memory-caching>NetBSD&rsquo;s Unified Buffer Cache</a> for more background information on this:</p>
<ul>
<li>
<p><strong>File pages</strong> correspond to chunks of memory that came directly from files on disk. These pages, if unmodified, can be freely discarded&mdash;and, if modified, they can be flushed back to their backing files. For example: pages used to run executable code can <em>always</em> be discarded because they are read-only and are backed by files on disk, whereas pages used via <code>mmap(2)</code> may or may not need to be flushed back to disk depending on their dirtiness status.</p>
</li>
<li>
<p><strong>Anonymous pages</strong> correspond to chunks of memory that an application allocated (think <code>malloc</code> or <code>new</code>). The contents of this memory has no meaning to the kernel and, because they are &ldquo;dynamically&rdquo; populated by program logic, they have no backing resource. As a result, if these pages have to be evicted, they have no file to go to so the kernel has to put them aside somewhere. That somewhere is the <em>swap area</em>.</p>
</li>
</ul>
<p>IMPORTANT: The key detail about page eviction, and the key detail you must retain for the reminder of this article, is that the page eviction process differs based on <em>where the page originally came from</em>.</p>
<p>If the system cannot find enough pages to evict (for example because it already evicted all file pages and there is not enough swap space to evict the remaining anonymous pages), the kernel will either panic or start terminating processes in an attempt to release used memory. On Linux this happens via the much &ldquo;beloved&rdquo; out-of-memory (OOM) killer.</p>
<p>As for how to decide which pages to evict from memory, each kernel has its own algorithm. In general, the kernel will implement an LRU algorithm to evict pages that are unlikely to be needed again soon. But it will also account for the &ldquo;cost&rdquo; of each eviction:</p>
<ol>
<li>
<p>The cheapest thing to do is to evict read-only file pages first because those don&rsquo;t need to be persisted with a disk write and can be quickly recovered.</p>
</li>
<li>
<p>The second cheapest thing is to evict dirty file pages given that they are already allocated in the file system and can be overwritten.</p>
</li>
<li>
<p>The most costly thing to do is to evict anonymous pages because these inevitably need to be written to the swap area&mdash;which in turn may involve some form of space allocation. You never want to reach a point where the system has to move pages to the swap space because, when you do, performance tanks.</p>
</li>
</ol>
<p>The specifics, however, are irrelevant for the remainder of this post.</p>
<h1 id=lets-run-chrome-and-bazel-together>Let&rsquo;s run Chrome and Bazel together</h1>
<p>With the background information out of the way, let&rsquo;s go back to the original discussion.</p>
<p>The traditional argument given to justify Chrome&rsquo;s huge memory usage is that the browser uses all the memory for caching. This is a good thing, the argument goes on, because you want a fast browsing experience, and caching as much data as possible in memory helps achieve that. And that&rsquo;s true&mldr; except for the little fact that Chrome doesn&rsquo;t run in a vacuum.</p>
<p>To see why this is a bad idea, let&rsquo;s apply Raymond Chen&rsquo;s <em>"<a href="https://devblogs.microsoft.com/oldnewthing/20050607-00/?p=35413">What if two programs did this?</a>"</em> analytical approach. The hungry browser can run along other programs, some of which might be memory-intensive too. To make our sample scenario realistic, let&rsquo;s throw Bazel into the mix, which is another app that loves to hug memory by caching the multi-GB build graph of a workspace. In this scenario, we have a programmer researching some information online via Chrome, writing some code (likely via some heavyweight IDE), and finally building the resulting project via Bazel.</p>
<p>Given this scenario, the programmer may use Chrome intensively upfront to do some research. During this process, Chrome&rsquo;s memory usage may grow to cover all available memory, caching rendered pages and images. Then the programmer may run Bazel to build the project, and Bazel may need to consume a lot of extra memory to load the full dependency graph. But&mldr; at that point, Bazel may not find enough available memory so the operating system will have to page out Chrome&rsquo;s cache memory. Switching back to Chrome later on may result in a <em>much slower</em> experience than if the browser had not cached anything in memory in the first place.</p>
<p>The problem here is that applications like Chrome and Bazel use anonymous memory to operate their own caches. While cache memory can be, by definition, discarded at any point, the only thing that the kernel sees when there is memory pressure is that these applications allocated large chunks of anonymous memory. The kernel has no idea whether these pages contain precious data that must be persisted, or volatile data that can be discarded. The nasty consequence is that the kernel may decide to move cached data to the swap area and, as I mentioned earlier, once you go to the swap you have already lost from a performance perspective.</p>
<p>Is there anything we can do about this?</p>
<h1 id=cooperative-memory-allocations>Cooperative memory allocations</h1>
<p>&ldquo;Well&rdquo;, you say, &ldquo;obviously we cannot allow applications to grab all memory for themselves. We should make them use up to X% of memory and leave some behind for other applications to use&rdquo;. (And, for the record, this is an actual solution that was proposed in the Bazel case.)</p>
<p>Except&mldr; this wouldn&rsquo;t fix anything: if the application itself is in control of checking current available memory and then making independent decisions about how much memory to use, we&rsquo;ll either end up in the same situation as above or, worse, we&rsquo;ll end up with applications that cannot use sufficient memory. Imagine if we had Chrome use, say, 80% of all memory because it knows to leave 20% unused. Then Bazel comes along, which is also configured to use 80% of <em>available</em> memory&mldr; which happens to be a tiny 80% of 20%. And thus Bazel is significantly penalized just because it happened to run second.</p>
<p>You might tweak this model and come up with a scheme that &ldquo;works&rdquo;, but distributed decisions on how to use memory are insufficient. First because you need an oracle (the kernel) that makes smart machine-wide decisions; and second because you cannot trust that all applications will follow the rules. After all, that&rsquo;s why we moved from cooperative multitasking to preemptive multitasking decades ago.</p>
<h1 id=enter-file-caching>Enter file caching</h1>
<p>Let&rsquo;s take a detour to explore a separate scenario: a bunch of applications that use little anonymous memory but that are heavy file system users. These applications open a lot of very large files each, keep them open for a long time, and perform random reads and writes on them. We have multiple instances of these applications running at once.</p>
<p>What we might see under this scenario is that overall system memory usage grows to almost 100%, just as before, but the swap remains empty. More importantly, while the system might be slow due to high CPU and I/O usage, its performance will remain predictable: launching a simple <code>ls</code> from the command line will be instantaneous and not be dragged by memory thrashing.</p>
<p>What&rsquo;s happening here is that all of the memory is now being used by the kernel as part of its file buffer cache; the applications themselves are not holding onto the memory. This kernel-level cache keeps track of file pages (not anonymous pages) to improve I/O performance by optimizing random I/O and sequential access (via prefetching). And this cache is typically allowed to grow to all available memory.</p>
<p>The key difference between this file-backed scenario and the previous scenario with Chrome and Bazel is that the kernel handles a unified cross-application cache, and that the kernel has full knowledge of this cache&rsquo;s contents. The kernel can make global decisions about the contents of this cache and keep all applications working as well as possible: if there is only one application running, all of the file buffer cache will be consumed by it; but if we have two or more applications, the cache will be shared &ldquo;fairly&rdquo;&mdash;and I put that in quotes because noisy neighbors are a real problem.</p>
<h1 id=the-root-cause>The root cause</h1>
<p>So what&rsquo;s the real problem with allowing Chrome to use all memory for its own caching?</p>
<p>Simply put, that the operating system has no visibility into the application&rsquo;s anonymous memory and cannot make decisions on its behalf. Therefore, when there is memory pressure, the only thing the kernel can do is push out anonymous memory pages to disk&mdash;even if those pages contained, essentially, a volatile cache&mdash;and restoring these later on from the swap area is very costly.</p>
<h1 id=any-solutions>Any solutions?</h1>
<p>You can imagine having a feedback mechanism between the kernel and the apps to reclaim memory. The kernel could say &ldquo;hey Chrome, I&rsquo;m running out of memory so please free some stuff you don&rsquo;t <em>really</em> need&rdquo; to request memory back. Unfortunately, this would not work because it would require all applications to comply and do the right thing in all cases. A single rogue or buggy application would hoard all memory, rendering a worse situation.</p>
<p>That said, Android implements such a solution. Android is designed so that the system can evict parts of an application (the activities) outright. The way this works is by having a protocol between the system and the application on how to handle controlled eviction: the system will first ask nicely that an application releases memory and allow the application to flush out data, but the system will then destroy that memory if the application does not comply. In either case, the application must be designed to recreate the state it was in before it was gracefully or forcefully shut down&mdash;as if it had never exited. Android has such a design because it first targeted mobile devices with very little memory <em>and</em> because mobile devices focus(ed) on one single application at a time.</p>
<p>Another solution could be to have a system-wide caching service to handle arbitrary memory objects from running applications. Such a service could then make coordinated decisions about memory usage across applications, shedding cache entries uniformly. But as in the previous solution, all applications would need to play along. Otherwise, a single non-conforming application could hoard memory and penalize all other applications that are trying to play by the rules.</p>
<p>Which brings us to yet another solution: partitioning the memory and pre-specifying how much each program can use upfront. This is what containers do in production, but is not a nice solution for personal computers: hard partitioning cannot dynamically adapt to user behavior. Sometimes you really only want to browse the web, and in that case you want all resources available to the browser.</p>
<p>And finally, we could try to shoehorn the applications into the facilities of existing systems. If applications leveraged files instead of anonymous memory to implement their caches, then the system&rsquo;s file buffer cache would do the right thing. Imagine if every application, instead of using <code>malloc</code> to get anonymous memory for its cacheable objects, used individual files to store them. Then, the application would use open/read/close cycles to access those cached objects. Under this scenario, the file cache in the kernel would do the right thing across applications: frequently used cache entries (files) would remain in memory, and under memory pressure, they could be cheaply evicted back to their backing files. Performance might suffer due to the extra system calls, but probably the net result would be better anyway. And, as it turns out, <a href=https://varnish-cache.org/docs/trunk/phk/notes.html>Varnish does exactly this</a>!</p>
<p>Unfortunately, all of the solutions above require some kind of coordination across programs and that all programs play by the rules. This might be workable under new systems designs (as Android has done) but retrofitting any of these into current systems is bound to not work. I wish it would though.</p>
<p>Finally, you might think that the above scenarios don&rsquo;t matter in today&rsquo;s world because computers have sufficient RAM. But they still do. Making concurrent Chrome and Bazel usage palatable on 16 GB laptops is precisely what I wanted to fix in my previous role at Google. And every time I notice slowdowns on my Surface Go 2, a new machine I bought a year ago but which only has 8 GB of RAM, these issues come to mind.</p>
<hr>
<p>So back to the original question: &ldquo;Should the browser use all available memory?&rdquo; No; not as it is done today. But yes if we had some better mechanisms for efficient cross-application caching.</p>
<p>Some food for thought 🙃 And if you do end up thinking about this, please share your comments using any of the buttons below!</p>
<p><strong>Edit (Aug 13th):</strong> Added reference to the article about Varnish following a suggestion from a Hacker News <a href="https://news.ycombinator.com/item?id=28167636">comment</a>.</p>
</article>
</div>
</div>
<div class="container post-links">
<div class=row>
<div class="col mr-auto text-left">
<span><a href=https://jmmv.dev/software/endtracker.html>&#171; Previous</a></span>
</div>
<div class="col text-center">
<span><a href=/archive.html>All posts</a></span>
</div>
<div class="col ml-auto text-right">
<span><a href=https://jmmv.dev/2021/08/useless-use-of-gnu.html>Next &#187;</a></span>
</div>
</div>
</div>
<div class="container post-votes">
<div class=row>
<div class="col-lg-4 my-2">
<div class=row>
<div class=col>
<a onclick=voteThumbsUp() class="btn btn-block btn-outline-success" id=thumbs-up-btn>👍
(<span id=thumbs-up-count>0</span>)</a>
</div>
<div class=col>
<a onclick=voteThumbsDown() class="btn btn-block btn-outline-danger" id=thumbs-down-btn>👎
(<span id=thumbs-down-count>0</span>)</a>
</div>
</div>
</div>
<div class="col-lg-8 my-2 d-none d-sm-block">
<div class=row>
<div class="col-md-4 text-center"><a href="https://www.reddit.com/submit?title=Should+the+browser+use+all+available+memory%3F&url=https%3A%2F%2Fjmmv.dev%2F2021%2F08%2Fusing-all-memory-as-a-cache.html" class="btn btn-block btn-outline-primary">
Share on
<img src=/images/badges/reddit.png alt=Reddit width=24 height=24>
</a>
</div>
<div class="col-md-4 text-center"><a href="https://news.ycombinator.com/item?id=28161538" class="btn btn-block btn-outline-primary">
Go to
<img src=/images/badges/ycombinator.png alt="Hacker News" width=24 height=24>
</a>
</div>
<div class="col-md-4 text-center"><a href="https://twitter.com/intent/tweet?status=Should+the+browser+use+all+available+memory%3F+%E2%80%94+https%3A%2F%2Fjmmv.dev%2F2021%2F08%2Fusing-all-memory-as-a-cache.html+%E2%80%94+cc+%40jmmv" class="btn btn-block btn-outline-primary">
Share on
<img src=/images/badges/Twitter_Social_Icon_Circle_Color.png alt=Twitter width=24 height=24>
</a>
</div>
</div>
</div>
</div>
<div class="row my-4" id=postCommentRow>
<div class=col>
<div class=media>
<img class=mr-3 src=/octicons/pencil.svg width=32px height=32px>
<div class="media-body container">
<form method=post id=newPost>
<div class=row>
<div class="col my-1">
<textarea class=form-control rows=1 id=postCommentContent onclick=showPostComment() placeholder="Leave a comment"></textarea>
</div>
</div>
<div class="row newPostControls" style=display:none>
<div class="col my-1 form-group">
<label for=postCommentAuthor>Your name (optional):</label>
<input type=text class=form-control id=postCommentAuthor>
</div>
</div>
<div class="row newPostControls" style=display:none>
<div class="col my-1 form-group">
<label for=postCommentEmail>Your email (optional):</label>
<input type=text class=form-control type=email id=postCommentEmail>
<small class="form-text text-muted">Invisible to all readers; if provided, you will receive notifications when replied to (not implemented yet)</small>
</div>
</div>
<div class=row id=postCommentError style=display:none>
<div class="col mt-1 alert-danger">
<p></p>
</div>
</div>
<div class="row newPostControls" style=display:none>
<button class="col-md-3 my-1 btn btn-primary" type=submit id=submitCommentButton>Post</button>
<small class="col-md-9 my-1 text-muted">Comments are subject to moderation. This feature is experimental and is powered by <a href=/software/endtracker.html>EndTRACKER</a>. If you experience any issues, please <a href=/about.html#contact>contact me off-band</a>.</small>
</div>
</form>
</div>
</div>
</div>
</div>
<script>function hidePostComment(){var a=document.getElementById('postCommentContent'),b;a.rows=1,a.value='',b=document.getElementsByClassName('newPostControls'),Array.prototype.forEach.call(b,function(a){a.style.display='none'})}function showPostComment(){var a=document.getElementById('postCommentContent'),b;a.rows=5,b=document.getElementsByClassName('newPostControls'),Array.prototype.forEach.call(b,function(a){a.style.display=''})}const form=document.querySelector('#newPost');form.onsubmit=function(a){a.preventDefault();let b=document.getElementById('postCommentAuthor').value,c=document.getElementById('postCommentEmail').value,d=document.getElementById('postCommentContent').value;postComment(b,c,d,hidePostComment)}</script>
</div>
<div class="container post-subscribe">
<div class=row>
<div class=col-sm-9>
<form action="https://api.follow.it/subscription-form/WWZwVlFmTks4enBrYytaNHorbE4zSnpRTTBoTy9PcXNsZjdQbVpmWDJDemwyVW9rc2llZHNxQW9iUGdXNG83dm11SWZDM0NKSlQ5Qm1LTUpJZnF2b0Z5WDE3UUtvaEgzTWRWUFBQWEo4RUxyNUt5UW4xN3VZaW9paEd1UUFCL1J8YStTYmVCc3VoVGhCeENNSVZHSmEyUk1hejZWaEZkT1M1WTVkSXdBY1Q5cz0=/8" method=post>
<div class=form-group>
<div class=row>
<input type=text name=email placeholder="Enter your email" class="form-control input-sm col-8 text-center">
<button type=submit class="btn btn-primary col-4">Subscribe</button>
</div>
</div>
</form>
</div>
<div class=col-sm-3>
<div class=row>
<div class="col px-2 text-center">
<a href="https://twitter.com/intent/follow?original_referer=https%3A%2F%2Fjmmv.dev%2F&screen_name=jmmv">
<img src=/images/badges/Twitter_logo_blue.svg width=32px height=32px alt="Follow @jmmv on Twitter">
</a>
</div>
<div class="col px-2 text-center">
<a href=/feed.xml><img src=/images/badges/feed-icon-28x28.png alt="RSS feed"></a>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="col-md-3 sidebar d-none d-md-block">
<div class=row>
<div class="col text-center p-2">
<p><a href=/about.html class=clear-link>
<img src=/images/avatars/20181124-snow.jpg class="rounded-circle shadow my-2" style=width:100px><br>
<b>Julio Merino</b><br>
Principal Software Engineer<br>
<small>#FreeBSD, #Unix, #Rust, #Bazel, #blogger</small><br>
<small>From Barcelona, living in Seattle</small>
</a></p>
<div class=row>
<div class="col-sm-6 text-center">
<p>
<a href="https://twitter.com/intent/follow?original_referer=https%3A%2F%2Fjmmv.dev%2F&screen_name=jmmv">
<img src=/images/badges/Twitter_logo_blue.svg width=32px height=32px alt="Follow @jmmv on Twitter">
</a>
</p>
</div>
<div class="col-sm-6 text-center">
<p><a href=/feed.xml><img src=/images/badges/feed-icon-28x28.png alt="RSS feed"></a></p>
</div>
</div>
<form action="https://api.follow.it/subscription-form/WWZwVlFmTks4enBrYytaNHorbE4zSnpRTTBoTy9PcXNsZjdQbVpmWDJDemwyVW9rc2llZHNxQW9iUGdXNG83dm11SWZDM0NKSlQ5Qm1LTUpJZnF2b0Z5WDE3UUtvaEgzTWRWUFBQWEo4RUxyNUt5UW4xN3VZaW9paEd1UUFCL1J8YStTYmVCc3VoVGhCeENNSVZHSmEyUk1hejZWaEZkT1M1WTVkSXdBY1Q5cz0=/8" method=post>
<div class=form-group>
<input type=text name=email placeholder="Enter your email" class="form-control input-sm text-center">
<button type=submit class="btn btn-primary btn-block">Subscribe</button>
</div>
</form>
</div>
</div>
<div class=row>
<div class=col>
<h2>Featured posts</h2>
<ul>
<li class=indent-wrapped-lines><a href=/2022/05/rust-is-hard-but-does-it-matter.html>Rust is hard, yes, but does it matter?</a></li>
<li class=indent-wrapped-lines><a href=/2022/04/rust-traits-and-dependency-injection.html>Rust traits and dependency injection</a></li>
<li class=indent-wrapped-lines><a href=/2022/03/a-year-on-windows-intro.html>A year on Windows: Introduction</a></li>
<li class=indent-wrapped-lines><a href=/2021/11/endbasic-0.8.html>EndBASIC 0.8: Now, with graphics!</a></li>
<li class=indent-wrapped-lines><a href=/2021/07/endbasic-0.7.html>EndBASIC 0.7: Hello, cloud!</a></li>
<li class=indent-wrapped-lines><a href=/2021/04/always-be-quitting.html>Always be quitting</a></li>
<li class=indent-wrapped-lines><a href=/2021/02/google-monorepos-and-caching.html>How does Google keep build times low?</a></li>
<li class=indent-wrapped-lines><a href=/2020/12/google-no-clean-builds.html>How does Google avoid clean builds?</a></li>
<li class=indent-wrapped-lines><a href=/2020/12/unit-testing-a-console-app.html>Unit-testing a console app (a text editor)</a></li>
<li class=indent-wrapped-lines><a href=/2020/11/wsl-lost-potential.html>Windows Subsystem for Linux: The lost potential</a></li>
<li class=indent-wrapped-lines><a href=/essays.html#featured>More...</a></li>
</ul>
</div>
</div>
<div class=row>
<div class=col>
<h2>Archive</h2>
<ul>
<li>
<a data-toggle=collapse href=#archive-year-2022>2022</a> (26)
<ul id=archive-year-2022 class=collapse>
<li><a href=/archive.html#2022-05>May 2022</a> (2)</li>
<li><a href=/archive.html#2022-04>April 2022</a> (4)</li>
<li><a href=/archive.html#2022-03>March 2022</a> (15)</li>
<li><a href=/archive.html#2022-02>February 2022</a> (4)</li>
<li><a href=/archive.html#2022-01>January 2022</a> (1)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2021>2021</a> (22)
<ul id=archive-year-2021 class=collapse>
<li><a href=/archive.html#2021-11>November 2021</a> (2)</li>
<li><a href=/archive.html#2021-08>August 2021</a> (2)</li>
<li><a href=/archive.html#2021-07>July 2021</a> (5)</li>
<li><a href=/archive.html#2021-06>June 2021</a> (1)</li>
<li><a href=/archive.html#2021-04>April 2021</a> (2)</li>
<li><a href=/archive.html#2021-03>March 2021</a> (2)</li>
<li><a href=/archive.html#2021-02>February 2021</a> (3)</li>
<li><a href=/archive.html#2021-01>January 2021</a> (5)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2020>2020</a> (36)
<ul id=archive-year-2020 class=collapse>
<li><a href=/archive.html#2020-12>December 2020</a> (4)</li>
<li><a href=/archive.html#2020-11>November 2020</a> (5)</li>
<li><a href=/archive.html#2020-10>October 2020</a> (5)</li>
<li><a href=/archive.html#2020-09>September 2020</a> (2)</li>
<li><a href=/archive.html#2020-08>August 2020</a> (6)</li>
<li><a href=/archive.html#2020-07>July 2020</a> (2)</li>
<li><a href=/archive.html#2020-06>June 2020</a> (2)</li>
<li><a href=/archive.html#2020-05>May 2020</a> (3)</li>
<li><a href=/archive.html#2020-04>April 2020</a> (2)</li>
<li><a href=/archive.html#2020-03>March 2020</a> (2)</li>
<li><a href=/archive.html#2020-02>February 2020</a> (1)</li>
<li><a href=/archive.html#2020-01>January 2020</a> (2)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2019>2019</a> (24)
<ul id=archive-year-2019 class=collapse>
<li><a href=/archive.html#2019-12>December 2019</a> (8)</li>
<li><a href=/archive.html#2019-11>November 2019</a> (6)</li>
<li><a href=/archive.html#2019-10>October 2019</a> (1)</li>
<li><a href=/archive.html#2019-09>September 2019</a> (2)</li>
<li><a href=/archive.html#2019-03>March 2019</a> (2)</li>
<li><a href=/archive.html#2019-02>February 2019</a> (3)</li>
<li><a href=/archive.html#2019-01>January 2019</a> (2)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2018>2018</a> (25)
<ul id=archive-year-2018 class=collapse>
<li><a href=/archive.html#2018-07>July 2018</a> (3)</li>
<li><a href=/archive.html#2018-06>June 2018</a> (7)</li>
<li><a href=/archive.html#2018-05>May 2018</a> (2)</li>
<li><a href=/archive.html#2018-04>April 2018</a> (2)</li>
<li><a href=/archive.html#2018-03>March 2018</a> (8)</li>
<li><a href=/archive.html#2018-02>February 2018</a> (3)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2017>2017</a> (6)
<ul id=archive-year-2017 class=collapse>
<li><a href=/archive.html#2017-10>October 2017</a> (1)</li>
<li><a href=/archive.html#2017-08>August 2017</a> (1)</li>
<li><a href=/archive.html#2017-07>July 2017</a> (1)</li>
<li><a href=/archive.html#2017-02>February 2017</a> (3)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2016>2016</a> (8)
<ul id=archive-year-2016 class=collapse>
<li><a href=/archive.html#2016-09>September 2016</a> (1)</li>
<li><a href=/archive.html#2016-05>May 2016</a> (1)</li>
<li><a href=/archive.html#2016-04>April 2016</a> (1)</li>
<li><a href=/archive.html#2016-03>March 2016</a> (2)</li>
<li><a href=/archive.html#2016-02>February 2016</a> (1)</li>
<li><a href=/archive.html#2016-01>January 2016</a> (2)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2015>2015</a> (17)
<ul id=archive-year-2015 class=collapse>
<li><a href=/archive.html#2015-12>December 2015</a> (2)</li>
<li><a href=/archive.html#2015-10>October 2015</a> (2)</li>
<li><a href=/archive.html#2015-09>September 2015</a> (3)</li>
<li><a href=/archive.html#2015-06>June 2015</a> (2)</li>
<li><a href=/archive.html#2015-05>May 2015</a> (3)</li>
<li><a href=/archive.html#2015-04>April 2015</a> (1)</li>
<li><a href=/archive.html#2015-03>March 2015</a> (1)</li>
<li><a href=/archive.html#2015-02>February 2015</a> (3)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2014>2014</a> (12)
<ul id=archive-year-2014 class=collapse>
<li><a href=/archive.html#2014-11>November 2014</a> (2)</li>
<li><a href=/archive.html#2014-05>May 2014</a> (3)</li>
<li><a href=/archive.html#2014-03>March 2014</a> (1)</li>
<li><a href=/archive.html#2014-02>February 2014</a> (3)</li>
<li><a href=/archive.html#2014-01>January 2014</a> (3)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2013>2013</a> (62)
<ul id=archive-year-2013 class=collapse>
<li><a href=/archive.html#2013-12>December 2013</a> (7)</li>
<li><a href=/archive.html#2013-11>November 2013</a> (7)</li>
<li><a href=/archive.html#2013-10>October 2013</a> (7)</li>
<li><a href=/archive.html#2013-09>September 2013</a> (13)</li>
<li><a href=/archive.html#2013-08>August 2013</a> (9)</li>
<li><a href=/archive.html#2013-07>July 2013</a> (10)</li>
<li><a href=/archive.html#2013-06>June 2013</a> (9)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2012>2012</a> (29)
<ul id=archive-year-2012 class=collapse>
<li><a href=/archive.html#2012-10>October 2012</a> (1)</li>
<li><a href=/archive.html#2012-09>September 2012</a> (1)</li>
<li><a href=/archive.html#2012-08>August 2012</a> (3)</li>
<li><a href=/archive.html#2012-07>July 2012</a> (2)</li>
<li><a href=/archive.html#2012-06>June 2012</a> (2)</li>
<li><a href=/archive.html#2012-05>May 2012</a> (3)</li>
<li><a href=/archive.html#2012-04>April 2012</a> (1)</li>
<li><a href=/archive.html#2012-03>March 2012</a> (1)</li>
<li><a href=/archive.html#2012-02>February 2012</a> (10)</li>
<li><a href=/archive.html#2012-01>January 2012</a> (5)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2011>2011</a> (60)
<ul id=archive-year-2011 class=collapse>
<li><a href=/archive.html#2011-12>December 2011</a> (4)</li>
<li><a href=/archive.html#2011-11>November 2011</a> (4)</li>
<li><a href=/archive.html#2011-10>October 2011</a> (5)</li>
<li><a href=/archive.html#2011-09>September 2011</a> (11)</li>
<li><a href=/archive.html#2011-08>August 2011</a> (6)</li>
<li><a href=/archive.html#2011-07>July 2011</a> (4)</li>
<li><a href=/archive.html#2011-06>June 2011</a> (6)</li>
<li><a href=/archive.html#2011-05>May 2011</a> (6)</li>
<li><a href=/archive.html#2011-04>April 2011</a> (5)</li>
<li><a href=/archive.html#2011-03>March 2011</a> (2)</li>
<li><a href=/archive.html#2011-01>January 2011</a> (7)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2010>2010</a> (26)
<ul id=archive-year-2010 class=collapse>
<li><a href=/archive.html#2010-12>December 2010</a> (7)</li>
<li><a href=/archive.html#2010-09>September 2010</a> (1)</li>
<li><a href=/archive.html#2010-07>July 2010</a> (1)</li>
<li><a href=/archive.html#2010-06>June 2010</a> (2)</li>
<li><a href=/archive.html#2010-05>May 2010</a> (5)</li>
<li><a href=/archive.html#2010-04>April 2010</a> (5)</li>
<li><a href=/archive.html#2010-03>March 2010</a> (3)</li>
<li><a href=/archive.html#2010-01>January 2010</a> (2)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2009>2009</a> (31)
<ul id=archive-year-2009 class=collapse>
<li><a href=/archive.html#2009-10>October 2009</a> (1)</li>
<li><a href=/archive.html#2009-09>September 2009</a> (1)</li>
<li><a href=/archive.html#2009-08>August 2009</a> (3)</li>
<li><a href=/archive.html#2009-07>July 2009</a> (2)</li>
<li><a href=/archive.html#2009-06>June 2009</a> (4)</li>
<li><a href=/archive.html#2009-05>May 2009</a> (6)</li>
<li><a href=/archive.html#2009-04>April 2009</a> (2)</li>
<li><a href=/archive.html#2009-03>March 2009</a> (4)</li>
<li><a href=/archive.html#2009-01>January 2009</a> (8)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2008>2008</a> (61)
<ul id=archive-year-2008 class=collapse>
<li><a href=/archive.html#2008-12>December 2008</a> (1)</li>
<li><a href=/archive.html#2008-11>November 2008</a> (4)</li>
<li><a href=/archive.html#2008-10>October 2008</a> (6)</li>
<li><a href=/archive.html#2008-09>September 2008</a> (1)</li>
<li><a href=/archive.html#2008-08>August 2008</a> (6)</li>
<li><a href=/archive.html#2008-07>July 2008</a> (14)</li>
<li><a href=/archive.html#2008-06>June 2008</a> (3)</li>
<li><a href=/archive.html#2008-05>May 2008</a> (1)</li>
<li><a href=/archive.html#2008-04>April 2008</a> (3)</li>
<li><a href=/archive.html#2008-03>March 2008</a> (3)</li>
<li><a href=/archive.html#2008-02>February 2008</a> (9)</li>
<li><a href=/archive.html#2008-01>January 2008</a> (10)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2007>2007</a> (86)
<ul id=archive-year-2007 class=collapse>
<li><a href=/archive.html#2007-12>December 2007</a> (4)</li>
<li><a href=/archive.html#2007-11>November 2007</a> (7)</li>
<li><a href=/archive.html#2007-10>October 2007</a> (2)</li>
<li><a href=/archive.html#2007-09>September 2007</a> (8)</li>
<li><a href=/archive.html#2007-08>August 2007</a> (6)</li>
<li><a href=/archive.html#2007-07>July 2007</a> (15)</li>
<li><a href=/archive.html#2007-06>June 2007</a> (15)</li>
<li><a href=/archive.html#2007-05>May 2007</a> (4)</li>
<li><a href=/archive.html#2007-04>April 2007</a> (10)</li>
<li><a href=/archive.html#2007-03>March 2007</a> (8)</li>
<li><a href=/archive.html#2007-02>February 2007</a> (1)</li>
<li><a href=/archive.html#2007-01>January 2007</a> (6)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2006>2006</a> (103)
<ul id=archive-year-2006 class=collapse>
<li><a href=/archive.html#2006-12>December 2006</a> (4)</li>
<li><a href=/archive.html#2006-11>November 2006</a> (3)</li>
<li><a href=/archive.html#2006-10>October 2006</a> (7)</li>
<li><a href=/archive.html#2006-09>September 2006</a> (6)</li>
<li><a href=/archive.html#2006-08>August 2006</a> (13)</li>
<li><a href=/archive.html#2006-07>July 2006</a> (4)</li>
<li><a href=/archive.html#2006-06>June 2006</a> (13)</li>
<li><a href=/archive.html#2006-05>May 2006</a> (7)</li>
<li><a href=/archive.html#2006-04>April 2006</a> (9)</li>
<li><a href=/archive.html#2006-03>March 2006</a> (6)</li>
<li><a href=/archive.html#2006-02>February 2006</a> (13)</li>
<li><a href=/archive.html#2006-01>January 2006</a> (18)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2005>2005</a> (129)
<ul id=archive-year-2005 class=collapse>
<li><a href=/archive.html#2005-12>December 2005</a> (9)</li>
<li><a href=/archive.html#2005-11>November 2005</a> (7)</li>
<li><a href=/archive.html#2005-10>October 2005</a> (23)</li>
<li><a href=/archive.html#2005-09>September 2005</a> (10)</li>
<li><a href=/archive.html#2005-08>August 2005</a> (14)</li>
<li><a href=/archive.html#2005-07>July 2005</a> (5)</li>
<li><a href=/archive.html#2005-06>June 2005</a> (12)</li>
<li><a href=/archive.html#2005-05>May 2005</a> (6)</li>
<li><a href=/archive.html#2005-04>April 2005</a> (6)</li>
<li><a href=/archive.html#2005-03>March 2005</a> (13)</li>
<li><a href=/archive.html#2005-02>February 2005</a> (11)</li>
<li><a href=/archive.html#2005-01>January 2005</a> (13)</li>
</ul>
</li>
<li>
<a data-toggle=collapse href=#archive-year-2004>2004</a> (84)
<ul id=archive-year-2004 class=collapse>
<li><a href=/archive.html#2004-12>December 2004</a> (9)</li>
<li><a href=/archive.html#2004-11>November 2004</a> (6)</li>
<li><a href=/archive.html#2004-10>October 2004</a> (11)</li>
<li><a href=/archive.html#2004-09>September 2004</a> (19)</li>
<li><a href=/archive.html#2004-07>July 2004</a> (29)</li>
<li><a href=/archive.html#2004-06>June 2004</a> (10)</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<footer class=container>
<div class=row>
<div class="col-4 order-2 texr-right">
<p class=float-right><a href=#>Back to top</a></p>
</div>
<div class="col-8 order-1 mr-auto">
<p>Copyright 2004&ndash;2022 Julio Merino</p>
</div>
</div>
</footer>
<script type=module>
  import {
    addAnchorsToHeaders, addElementClasses, CommentsClient, RequestsClient, VotingClient,
  } from "\/js\/main.d7e5495574f64e3c74600e1ded9c151f64da7504303fd1498c445b1457ae99dc.js";

  var requestsClient = new RequestsClient(SITE_ID);
  requestsClient.saveRequest();

  var votingClient = new VotingClient(SITE_ID);
  votingClient.loadVotes();
  window.voteThumbsUp = function() { votingClient.voteThumbsUp(); }
  window.voteThumbsDown = function() { votingClient.voteThumbsDown(); }

  var commentsClient = new CommentsClient(SITE_ID);
  commentsClient.loadComments();
  window.postComment = function(...args) {
    commentsClient.postComment(...args);
  };

  addAnchorsToHeaders();
  addElementClasses();
</script>
<noscript>
<img src=https://hugo-dynamic.jmmv.dev/api/sites/e8da9f62-b7ac-4fe9-bf20-7c527199a376/pages/aHR0cHM6Ly9qbW12LmRldi8yMDIxLzA4L3VzaW5nLWFsbC1tZW1vcnktYXMtYS1jYWNoZS5odG1s/stamp.gif style=display:none>
</noscript>
</body>
</html>