<!doctype html><html lang=en xmlns=http://www.w3.org/1999/xhtml xmlns:fb=http://ogp.me/ns/fb#><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta property="og:site_name" content="Julio Merino (jmmv.dev)"><meta property="twitter:site" content="@jmmv"><title>Analyzing OOMs in IntelliJ with Bazel - Julio Merino (jmmv.dev)</title><meta property="og:title" content="Analyzing OOMs in IntelliJ with Bazel - Julio Merino (jmmv.dev)"><meta property="twitter:title" content="Analyzing OOMs in IntelliJ with Bazel - Julio Merino (jmmv.dev)"><meta name=description content="A few months ago, we described how we fixed three different OOM scenarios in our ongoing migration to the Bazel build system here at Snowflake. Things had been sailing along just fine since then&amp;hellip; but a new issue showed up recently: our IntelliJ with Bazel (IjwB) Java project started showing OOMs during its sync phase.
The reason this issue surfaced now is because, as we continue our migration to Bazel, our IjwB project has grown in size."><meta property="og:description" content="A few months ago, we described how we fixed three different OOM scenarios in our ongoing migration to the Bazel build system here at Snowflake. Things had been sailing along just fine since then&amp;hellip; but a new issue showed up recently: our IntelliJ with Bazel (IjwB) Java project started showing OOMs during its sync phase.
The reason this issue surfaced now is because, as we continue our migration to Bazel, our IjwB project has grown in size."><meta property="twitter:description" content="A few months ago, we described how we fixed three different OOM scenarios in our ongoing migration to the Bazel build system here at Snowflake. Things had been sailing along just fine since ‚Ä¶"><meta name=author content="Julio Merino"><meta property="twitter:creator" content="@jmmv"><meta name=generator content="Hugo 0.111.3"><meta property="og:url" content="https://jmmv.dev/2023/10/analyzing-ooms-in-intellij-with-bazel.html"><meta property="og:type" content="blog"><meta property="twitter:card" content="summary"><link rel=canonical href=https://jmmv.dev/2023/10/analyzing-ooms-in-intellij-with-bazel.html><link rel=alternate type=application/rss+xml title="Julio Merino (jmmv.dev)" href=/feed.xml><link rel=stylesheet href=/sass/main.min.161663676cac4bf21abc8967ec3267c26026aa58e9f392c5f3427e0ef089fe6b.css><link rel=stylesheet href=/css/chroma.css><link rel=icon type=image/png href=/images/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/images/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicons/favicon-96x96.png sizes=96x96><meta property="og:image" content="/images/favicons/favicon-1200x1200.png"><meta property="twitter:image" content="https://jmmv.dev/images/favicons/favicon-1200x1200.png"><script>const SITE_ID="e8da9f62-b7ac-4fe9-bf20-7c527199a376",BASE_URL="https://jmmv.dev/"</script></head><body><header class=site-header><nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-primary"><a class=navbar-brand href=/><img src=/images/favicons/favicon-30x30.png width=30 height=30 class="d-inline-block align-top" alt>
&nbsp;Julio Merino</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=/about.html>About</a></li><li class=nav-item><a class=nav-link href=/essays.html>Essays</a></li><li class=nav-item><a class=nav-link href=/resume.html>Resume</a></li><li class=nav-item><a class=nav-link href=/software.html>Software</a></li></ul><ul class="navbar-nav mr-4"><li class=nav-item><a class=nav-link href=/archive.html>Archive</a></li><li class=nav-item><a class=nav-link href=/series.html>Series</a></li><li class=nav-item><a class=nav-link href=/tags.html>Tags</a></li></ul><form class=form-inline method=get role=search action=https://www.google.com/search><div class=input-group><input type=search name=query class=form-control placeholder=Search aria-label=Search><div class=input-group-append><button type=submit value=Search class="btn btn-light">
<img src=/octicons/search.svg></button></div></div><input type=hidden name=sitesearch value=https://jmmv.dev/></form></div></nav></header><div class=page-header><div class=container><h1>Analyzing OOMs in IntelliJ with Bazel</h1><p>October 7, 2023 &#183;
About 9 minutes
&#183;
Tags:
<a href=/tags/bazel>bazel</a>, <a href=/tags/snowflake>snowflake</a></p><p class=post-meta-p>This article was
<a href=https://medium.com/snowflake/analyzing-ooms-in-intellij-with-bazel-bc96818ac5a9>originally published
on Medium</a>
in the <a href=https://medium.com/snowflake>Snowflake publication</a>
and is replicated here <a href=/2016/01/medium-experiment-wrapup.html>for
archival purposes</a>.</p></div></div><div class="container post-body"><div class=row><div class=col-md-9><div class=row><div class=col><article><p>A few months ago, we described how we fixed <a href=/2023/03/addressing-bazel-ooms.html>three different OOM scenarios</a> in our ongoing migration to the Bazel build system here at Snowflake. Things had been sailing along just fine since then&mldr; but a new issue showed up recently: our <a href=https://ij.bazel.build/>IntelliJ with Bazel (IjwB)</a> Java project started showing OOMs during its sync phase.</p><p>The reason this issue surfaced now is because, as we continue our migration to Bazel, our IjwB project has grown in size. Months ago, our project only covered a Java binary, but now that we have migrated all of its unit and integration tests as well, the project covers them too. It is common for tests to be more expensive to build and run than the binary they validate&mdash;tests depend on the binary&rsquo;s dependencies <em>plus</em> many other helper tools for testing&mdash;and these caused the project to grow too big to fit in our development environments. Or did they?</p><h1 id=context-setting>Context-setting</h1><p>We run Bazel in a memory-constrained VM. We do this intentionally to support our varied fleet of corp laptops: our new hires get top-of-the-line M2 Max Macbooks, but a substantial number of developers are a few months away from a hardware refresh and may not have as much RAM.</p><p>Up until now, giving a 4GB max heap to Bazel had been plenty to build and test our codebase. But, remember, things weren&rsquo;t always this way: about a year ago, during our initial onboarding of remote execution, we had to bump the max heap size to 12GB. This bump was not sustainable due to the VM memory limits, and these limits forced us to pause and analyze why we needed much more RAM than the previous build system for similar user flows. This principled approach led us to find the right knobs in Bazel to make it run within the more reasonable 4GB limit and thus we avoided bumping up the resource requirements of the VM.</p><p>Syncing our project in IjwB is another one of those situations where a constrained environment has been beneficial to discover inefficiencies and fix them in a way that doesn&rsquo;t require wasting everyone&rsquo;s resources. The naive solution to our problems would have been to increase Bazel&rsquo;s max heap to 12 GB again with a corresponding bump in the VM memory allocation, telling all engineers with older laptops to refresh them. But&mldr; that&rsquo;d have been expensive and, worse, it would have left a sour taste for the ongoing Bazel migration.</p><p>So the question was: if a max heap of 4GB was sufficient to build and test all of our codebase&mldr; why did we need three times more memory &ldquo;just&rdquo; to sync the IjwB project? Our project is big&mldr; but not <em>that</em> big.</p><h1 id=ijwb-project-syncing-and-sharding>IjwB project syncing and sharding</h1><p>Project syncing in IjwB is an expensive operation. What this process does is build the project&rsquo;s targets with a <a href=https://bazel.build/extending/aspects>Bazel aspect</a> provided by the <a href=https://plugins.jetbrains.com/plugin/8609-bazel-for-intellij>IjwB plugin</a>. This aspect attaches to the targets defined in the project file and extracts the information that the IDE needs to index them. This aspect is expensive in terms of memory consumption and was expected to throw off our earlier predictions on Bazel&rsquo;s max heap needs.</p><p>That said, because this aspect is known to be expensive, IjwB provides <a href=https://ij.bazel.build/docs/project-views.html#shard_sync>a feature to shard the syncing process</a> in an attempt to reduce peak memory consumption. The idea behind project sharding is to make IjwB run the sync process on smaller sets of targets at a time instead of on the full project at once. For example, if the project specifies <code>//server/...</code> as the target pattern to sync, IjwB will query all targets beneath <code>//server/...</code>, divide them into roughly-equally sized groups, and then sync those groups separately instead of passing <code>//server/...</code> to a single Bazel invocation.</p><p>This feature was originally designed at Google to help with syncing gigantic targets in their monorepo, and it worked nicely for them. But, for some reason, it did not work for us. We tried multiple sharding settings and Bazel would still OOM. The key difference between our setup and Google&rsquo;s was the memory constraint on Bazel&rsquo;s max heap: we set this to 4GB while Google typically runs Bazel on powerful workstations with memory to spare and thus much higher max heap sizes.</p><p>Could we do anything about it?</p><h1 id=profiling>Profiling</h1><p>To understand what was going on, we had to profile heap usage. Here is a first look into Bazel&rsquo;s memory consumption as displayed by VisualVM for the duration of the IjwB project sync. This run was done with about 8 shards and a max heap of 12GB to try to measure the &ldquo;worst case&rdquo; scenario for our build:</p><figure><img src=/images/2023-10-07-12gb-heap-no-discard.png class=with-border><figcaption>Timeline of heap memory usage as captured by VisualVM with a max heap size of 12GB. The picture shows memory growing to about 7GB of retained heap even after two GC cycles.</figcaption></figure><p>What&rsquo;s interesting to note about this profile is that memory consumption grows over time and that JVM Garbage Collection (GC) cycles cannot bring it down to the initial low baseline. More importantly, the GC cycle after the sync steps complete still leaves the Bazel process consuming about 7GB. Based on this data, a small heap of 4GB seemed unfeasible given that Bazel wanted to retain much more memory than that. But&mldr; this was surprising because sharded syncing should have kept memory usage low. So, was this memory consumption legitimate or a memory leak?</p><p>To answer this question, I had to peek into a heap dump that I captured in VisualVM after one of the first shards completed syncing. I did this at the beginning of the process and not at the end to try to keep the dump small, but regardless, I ended up with a 5GB dump.</p><p>Opening the heap dump in a visualization tool was its own odyssey, which I expected going in due to the dump&rsquo;s size. <a href=https://eclipse.dev/mat/>Eclipse Memory Analyzer</a> (MAT for short) is a highly recommended tool, so I tried to open the profile in it. After more than an hour, however, MAT wasn&rsquo;t able to finish. Looking a bit more into this, I found that MAT was configured with a 1GB max heap&mldr; and thus the JVM was GC-thrashing. Bumping&mdash;hah, the irony!&mdash;the MAT&rsquo;s max heap to 8GB was sufficient to let it open the profile in just a few minutes.</p><p>Upon opening MAT and asking for a <strong>Suspected Leaks</strong> report, here is what I faced:</p><figure><img src=/images/2023-10-07-leak-suspects-overview.png class=with-border><figcaption>MAT showing the Suspected Leaks overview.</figcaption></figure><p>Based on this initial data, we can see that <a href=https://bazel.build/reference/skyframe>Skyframe</a>&mdash;the thing that holds Bazel&rsquo;s in-memory graph and performs operations on it&mdash;is holding onto the retained memory. But MAT is awesome! We can click on <strong>Details</strong> to dig further:</p><figure><img src=/images/2023-10-07-leak-suspects-details.png class=with-border><figcaption>MAT showing the Suspected Leaks details.</figcaption></figure><p>And finally, we can right-click onto the Skyframe executor object retaining those 3GB of RAM to dive into the objects hanging from it:</p><figure><img src=/images/2023-10-07-leak-suspects-classes.png class=with-border><figcaption>MAT drilling down into the classes consuming the most memory.</figcaption></figure><p>What we see here is that below the Skyframe graph instance, memory consumption is smeared all over the place. This makes sense: Skyframe is a graph engine so memory usage will be distributed across all nodes that the engine maintains. Some of those nodes will be heavier than others, but we should expect to see a reasonably even spread.</p><p>While poking through these entries, I reached a node that claimed <code>SourceArtifactCache</code> was retaining most of the memory. In retrospect, this conclusion was wrong because <code>SourceArtifactCache</code> was holding onto about 3,000,000 bytes, which was three orders of magnitude smaller than the total used memory&mldr; but I misread the numbers and thought they were the same. That was a fortunate accident though. Looking through the source code for the <code>SourceArtifactCache</code>, I found that it is only discarded when the analysis graph is discarded in full. And looking a bit further, I found the <code>--discard_analysis_cache</code> flag to forcibly discard this cache.</p><p>Bingo. By adding <code>--discard_analysis_cache</code> to the <code>sync_flags</code> list in the IjwB project definition, I could observe the following behavior during the project sync, still with a 12GB max heap:</p><figure><img src=/images/2023-10-07-12gb-heap-discard.png class=with-border><figcaption>Timeline of heap memory usage as captured by VisualVM with a max heap size of 12GB. The picture shows memory growing to about 5GB of retained heap, and three highlights for when graph discards happen.</figcaption></figure><p>Note the clear memory consumption drops that happen after every shard finishes syncing and Bazel discards the analysis graph. Furthermore, we can see that peak memory usage now hovers at around 4GB throughout the process, which is much better than the previous 8GB. This means that combining this flag with the sharded project sync in IjwB could lead to the initial promise of reducing memory usage by using sharding.</p><p>Knowing this, the final question was: is the memory used above 4GB throughout this process retained, or is it memory that could be discarded by more frequent GC activity? In other words: if we clamp the max heap back down to 4GB, will GC kick in and maintain Bazel under it? Here is the answer:</p><figure><img src=/images/2023-10-07-4gb-heap-discard.png class=with-border><figcaption>Timeline of heap memory usage as captured by VisualVM with a max heap size of 4GB. The picture shows memory growing close to 4GB of retained heap, with a sawtooth pattern indicating frequent GC cycles at that point in time, and four highlights for when graph discards happen later on.</figcaption></figure><p>Voila. GC struggled to keep up for a brief period of time as shown in the picture, but the whole project sync process was able to complete and remained at around 2&ndash;3GB throughout.</p><p>The GC churn depicted here is still not great but it&rsquo;s only a deficiency of our sharding approach. I mentioned at the beginning of the article that IjwB is in charge of project sharding, but that was an oversimplification. Due to <a href=https://github.com/bazelbuild/intellij/issues/4546>an issue in the IjwB plugin</a>, we have had to temporarily implement our own sharding strategy, and our sharding causes one of the initial shards to be larger than the others. We expect to see better behavior once we switch to the plugin&rsquo;s built-in sharding strategy now that <a href=https://github.com/bazelbuild/intellij/pull/5085>the issue has been fixed</a>.</p><h1 id=takeaways>Takeaways</h1><p>The obvious takeaway from all of this is: if IjwB&rsquo;s sharding feature is insufficient to let you sync large projects under a tight memory constraint, try to pass <code>--discard_analysis_cache</code> in <code>sync_flags</code> and see if it helps. This may let you lower your overall Bazel memory footprint, freeing resources for other processes.</p><p>But what&rsquo;s more interesting is that while environments with tight memory limits are annoying to deal with, pausing to analyze why new Bazel-based workflows seem to need more memory than legacy ones can help identify alternative solutions. In the previous article, we found how to keep Bazel&rsquo;s memory under control when handling hundreds of remote build actions, and in this article, we found how to tame memory usage during IjwB project syncs. While dealing with these issues is tricky, it is crucial to address them during a build system migration to increase trust in the new system.</p><p>To conclude, let me say that memory-constrained scenarios like ours are not common and that Bazel is already doing the right thing in the common case. That doesn&rsquo;t mean there is no room for improvement, so we filed bug <a href=https://github.com/bazelbuild/bazel/issues/19412>#19412</a> to start a discussion. The upstream Bazel developers confirmed that they are working on optimizing memory consumption and also suggested that we try other flags such as <code>--notrack_incremental_state</code>. Furthermore, there might actually be undiagnosed inefficiencies in the aspect that IjwB uses to sync the project. Watch that bug for further developments!</p></article></div></div><div class="container post-links"><div class=row><div class="col mr-auto text-left"><span><a href=https://jmmv.dev/2023/10/rust-test-structs.html>&#171; Previous</a></span></div><div class="col text-center"><span><a href=/archive.html>All posts</a></span></div><div class="col ml-auto text-right"><span><a href=https://jmmv.dev/2023/10/unit-testing-with-shtk.html>Next &#187;</a></span></div></div></div><div class="container post-votes"><div class=row><div class="col-lg-4 my-2"><div class=row><div class=col><a onclick=voteThumbsUp() class="btn btn-block btn-outline-success" id=thumbs-up-btn>üëç
(<span id=thumbs-up-count>0</span>)</a></div><div class=col><a onclick=voteThumbsDown() class="btn btn-block btn-outline-danger" id=thumbs-down-btn>üëé
(<span id=thumbs-down-count>0</span>)</a></div></div></div><div class="col-lg-8 my-2 d-none d-sm-block"><div class=row><div class="col-md-4 text-center"><a href="https://www.reddit.com/submit?title=Analyzing+OOMs+in+IntelliJ+with+Bazel&amp;url=https%3A%2F%2Fjmmv.dev%2F2023%2F10%2Fanalyzing-ooms-in-intellij-with-bazel.html" class="btn btn-block btn-outline-primary">Share on
<img src=/images/badges/reddit.png alt=Reddit width=24 height=24></a></div><div class="col-md-4 text-center"><a href="https://news.ycombinator.com/submitlink?t=Analyzing+OOMs+in+IntelliJ+with+Bazel&amp;u=https%3A%2F%2Fjmmv.dev%2F2023%2F10%2Fanalyzing-ooms-in-intellij-with-bazel.html" class="btn btn-block btn-outline-primary">Share on
<img src=/images/badges/ycombinator.png alt="Hacker News" width=24 height=24></a></div><div class="col-md-4 text-center"><a href="https://twitter.com/intent/tweet?status=Analyzing+OOMs+in+IntelliJ+with+Bazel+%E2%80%94+https%3A%2F%2Fjmmv.dev%2F2023%2F10%2Fanalyzing-ooms-in-intellij-with-bazel.html+%E2%80%94+cc+%40jmmv" class="btn btn-block btn-outline-primary">Share on
<img src=/images/badges/Twitter_Social_Icon_Circle_Color.png alt=Twitter width=24 height=24></a></div></div></div></div><div class="row my-4" id=postCommentRow><div class=col><div class=media><img class=mr-3 src=/octicons/pencil.svg width=32px height=32px><div class="media-body container"><form method=post id=newPost><div class=row><div class="col my-1"><textarea class=form-control rows=1 id=postCommentContent onclick=showPostComment() placeholder="Leave a comment"></textarea></div></div><div class="row newPostControls" style=display:none><div class="col my-1 form-group"><label for=postCommentAuthor>Your name (optional):</label>
<input type=text class=form-control id=postCommentAuthor></div></div><div class="row newPostControls" style=display:none><div class="col my-1 form-group"><label for=postCommentEmail>Your email (optional):</label>
<input type=text class=form-control type=email id=postCommentEmail>
<small class="form-text text-muted">Invisible to all readers; if provided, you will receive notifications when replied to (not implemented yet)</small></div></div><div class=row id=postCommentError style=display:none><div class="col mt-1 alert-danger"><p></p></div></div><div class="row newPostControls" style=display:none><button class="col-md-3 my-1 btn btn-primary" type=submit id=submitCommentButton>Post</button>
<small class="col-md-9 my-1 text-muted">Comments are subject to moderation. This feature is experimental and is powered by <a href=/software/endtracker.html>EndTRACKER</a>. If you experience any issues, please <a href=/about.html#contact>contact me off-band</a>.</small></div></form></div></div></div></div><script>function hidePostComment(){var t,e=document.getElementById("postCommentContent");e.rows=1,e.value="",t=document.getElementsByClassName("newPostControls"),Array.prototype.forEach.call(t,function(e){e.style.display="none"})}function showPostComment(){var e,t=document.getElementById("postCommentContent");t.rows=5,e=document.getElementsByClassName("newPostControls"),Array.prototype.forEach.call(e,function(e){e.style.display=""})}const form=document.querySelector("#newPost");form.onsubmit=function(e){e.preventDefault();let t=document.getElementById("postCommentAuthor").value,n=document.getElementById("postCommentEmail").value,s=document.getElementById("postCommentContent").value;postComment(t,n,s,hidePostComment)}</script></div></div><div class="col-md-3 sidebar d-none d-md-block"><div class=row><div class="col text-center p-2"><p><a href=/about.html class=clear-link><img src=/images/avatars/20181124-snow.jpg class="rounded-circle shadow my-2" style=width:100px><br><b>Julio Merino</b><br>A blog on operating systems, programming languages, testing, build systems, my own software
projects and even personal productivity. Specifics include FreeBSD, Linux, Rust, Bazel and
EndBASIC.</a></p><div class=row><div class=col><div class=form-group><form action=https://endtracker.azurewebsites.net/api/sites/e8da9f62-b7ac-4fe9-bf20-7c527199a376/subscribers/add method=post><input type=text name=email placeholder="Enter your email" class="form-control input-sm text-center my-1">
<button type=submit class="btn btn-primary btn-block my-1">Subscribe</button></form></div></div></div><div class="row px-2"><div class="col-sm-5 text-left"><small><span class=subscriber-count>0</span> subscribers</small></div><div class="col-sm-7 text-right"><p><a rel=me href=https://mastodon.online/@jmmv><img src=/images/badges/mastodon-logo.svg width=32px height=32px alt="Follow @jmmv on Mastodon"></a>
<a href="https://twitter.com/intent/follow?original_referer=https%3A%2F%2Fjmmv.dev%2F&amp;screen_name=jmmv"><img src=/images/badges/Twitter_logo_blue.svg width=32px height=32px alt="Follow @jmmv on Twitter"></a>
<a href=/feed.xml><img src=/images/badges/feed-icon-28x28.png alt="RSS feed"></a></p></div></div></div></div><div class=row><div class=col><h2>Featured software</h2><ul><li class=overflow-ellipsis><a href=https://www.endbasic.dev/ target=_blank>EndBASIC: Online BASIC+DOS env</a></li><li class=overflow-ellipsis><a href=https://endtracker.azurewebsites.net/ target=_blank>EndTRACKER: Services for static sites</a></li></ul></div></div><div class=row><div class=col><h2>Featured posts</h2><ul><li class=overflow-ellipsis><a href=/2023/06/fast-machines-slow-machines.html>Fast machines, slow machines</a></li><li class=overflow-ellipsis><a href=/2022/12/endbasic-0.10.html>EndBASIC 0.10: Core language, evolved</a></li><li class=overflow-ellipsis><a href=/2022/10/bye-microsoft-hi-snowflake.html>Farewell, Microsoft; hello, Snowflake!</a></li><li class=overflow-ellipsis><a href=/2022/05/rust-is-hard-but-does-it-matter.html>Rust is hard, yes, but does it matter?</a></li><li class=overflow-ellipsis><a href=/2022/04/rust-traits-and-dependency-injection.html>Rust traits and dependency injection</a></li><li class=overflow-ellipsis><a href=/2022/03/a-year-on-windows-intro.html>A year on Windows: Introduction</a></li><li class=overflow-ellipsis><a href=/2021/04/always-be-quitting.html>Always be quitting</a></li><li class=overflow-ellipsis><a href=/2021/02/google-monorepos-and-caching.html>How does Google keep build times low?</a></li><li class=overflow-ellipsis><a href=/2020/12/google-no-clean-builds.html>How does Google avoid clean builds?</a></li><li class=overflow-ellipsis><a href=/2020/12/unit-testing-a-console-app.html>Unit-testing a console app (a text editor)</a></li><li class=overflow-ellipsis><a href=/essays.html#featured>More...</a></li></ul></div></div></div></div></div><footer class=container><div class=row><div class="col-4 order-2 texr-right"><p class=float-right><a href=#>Back to top</a></p></div><div class="col-8 order-1 mr-auto"><p>Copyright 2004&ndash;2023 Julio Merino</p></div></div></footer><script type=module>
  import { addAnchorsToHeaders, addElementClasses, BatchClient } from "\/js\/main.d30f168b11d80082408f4a983af9a626c6e57d58f7846b2174bac40d43be33e3.js";

  var batchClient = new BatchClient(SITE_ID);
  batchClient.doAll({
    put_request: true, get_comments: true, get_subscriber_count: true, get_votes: true });

  window.voteThumbsUp = function() { batchClient.voteThumbsUp(); }
  window.voteThumbsDown = function() { batchClient.voteThumbsDown(); }

  window.postComment = function(...args) {
    batchClient.postComment(...args);
  };

  addAnchorsToHeaders();
  addElementClasses();
</script><noscript><img src="https://hugo-dynamic.jmmv.dev/api/sites/e8da9f62-b7ac-4fe9-bf20-7c527199a376/pages/aHR0cHM6Ly9qbW12LmRldi8yMDIzLzEwL2FuYWx5emluZy1vb21zLWluLWludGVsbGlqLXdpdGgtYmF6ZWwuaHRtbA==/stamp.gif" style=display:none></noscript></body></html>