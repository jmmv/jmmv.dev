<!doctype html><html lang=en xmlns=http://www.w3.org/1999/xhtml xmlns:fb=http://ogp.me/ns/fb#><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta property="og:site_name" content="Julio Merino (jmmv.dev)"><meta property="twitter:site" content="@jmmv"><title>Build farm visualizations - Julio Merino (jmmv.dev)</title>
<meta property="og:title" content="Build farm visualizations - Julio Merino (jmmv.dev)"><meta property="twitter:title" content="Build farm visualizations - Julio Merino (jmmv.dev)"><meta name=description content="If you have followed our recent infrastructure posts, you know by now that we are actively migrating Snowflake&rsquo;s build to Bazel. What we haven&rsquo;t shared yet is that we have deployed our own Build Barn cluster to support Bazel&rsquo;s remote execution features. We have chosen to run our own build farm service for resource governance and security purposes, but also because the behavior of this system impacts the developer experience so directly that we want to have full in-house control and knowledge of it.
"><meta property="og:description" content="If you have followed our recent infrastructure posts, you know by now that we are actively migrating Snowflake&rsquo;s build to Bazel. What we haven&rsquo;t shared yet is that we have deployed our own Build Barn cluster to support Bazel&rsquo;s remote execution features. We have chosen to run our own build farm service for resource governance and security purposes, but also because the behavior of this system impacts the developer experience so directly that we want to have full in-house control and knowledge of it.
"><meta property="twitter:description" content="If you have followed our recent infrastructure posts, you know by now that we are actively migrating Snowflake&rsquo;s build to Bazel. What we haven&rsquo;t shared yet is that we have deployed our own …"><meta name=author content="Julio Merino"><meta property="twitter:creator" content="@jmmv"><meta name=generator content="Hugo 0.145.0"><meta property="og:url" content="https://jmmv.dev/2023/10/build-farm-visualizations.html"><meta property="og:type" content="blog"><meta property="twitter:card" content="summary"><link rel=canonical href=https://jmmv.dev/2023/10/build-farm-visualizations.html><link rel=alternate type=application/rss+xml title="Julio Merino (jmmv.dev)" href=/feed.xml><link rel=stylesheet href=/sass/main.min.cb91349cd93211a37e7d5dc131c35a170fc795721c03373cd05571327eea206b.css><link rel=stylesheet href=/css/chroma.css><link rel=icon type=image/png href=/images/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/images/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicons/favicon-96x96.png sizes=96x96><meta property="og:image" content="/images/favicons/favicon-1200x1200.png"><meta property="twitter:image" content="https://jmmv.dev/images/favicons/favicon-1200x1200.png"><script>const SITE_ID="e8da9f62-b7ac-4fe9-bf20-7c527199a376",BASE_URL="https://jmmv.dev/"</script></head><body><img src="https://hugo-dynamic.jmmv.dev/api/sites/e8da9f62-b7ac-4fe9-bf20-7c527199a376/pages/aHR0cHM6Ly9qbW12LmRldi8yMDIzLzEwL2J1aWxkLWZhcm0tdmlzdWFsaXphdGlvbnMuaHRtbA==/stamp.gif" style=display:none>
<script>window.location.replace("https://medium.com/snowflake/build-farm-visualizations-5a079477502d")</script><header class=site-header><nav class="navbar navbar-expand-md fixed-top navbar-dark bg-primary"><a class=navbar-brand href=/><img src=/images/favicons/favicon-30x30.png width=30 height=30 class="d-inline-block align-top" alt>
&nbsp;jmmv.dev
</a><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=/about.html>About</a></li><li class=nav-item><a class=nav-link href=/blog.html>Blog</a></li><li class=nav-item><a class=nav-link href=/resume.html>Resume</a></li><li class=nav-item><a class=nav-link href=/software.html>Software</a></li></ul><ul class="navbar-nav mr-4"><li class=nav-item><a class=nav-link href=/archive.html>Archive</a></li><li class=nav-item><a class=nav-link href=/series.html>Series</a></li><li class=nav-item><a class=nav-link href=/tags.html>Tags</a></li></ul><form class=form-inline method=get role=search action=https://www.google.com/search><div class=input-group><input type=search name=query class=form-control placeholder=Search aria-label=Search><div class=input-group-append><button type=submit value=Search class="btn btn-light">
<img src=/octicons/search.svg></button></div></div><input type=hidden name=sitesearch value=https://jmmv.dev/></form></div></nav></header><div class=page-header><div class=container><h1>Build farm visualizations</h1><p>October 20, 2023 &#183;
About 10 minutes
&#183;
Tags:
<a href=/tags/bazel>bazel</a>, <a href=/tags/snowflake>snowflake</a></p><p class=post-meta-p>This article was
<a href=https://medium.com/snowflake/build-farm-visualizations-5a079477502d>originally published
on Medium</a>
in the <a href=https://medium.com/snowflake>Snowflake publication</a>
and is replicated here <a href=/2016/01/medium-experiment-wrapup.html>for
archival purposes</a>.</p></div></div><div class="container post-body"><div class=row><div class=col-md-9><div class=row><div class=col><article><p>If you have followed our <a href=https://medium.com/snowflake/tagged/infrastructure>recent infrastructure posts</a>, you know by now that we are actively migrating Snowflake&rsquo;s build to Bazel. What we haven&rsquo;t shared yet is that we have deployed our own <a href=https://github.com/buildbarn>Build Barn</a> cluster to support Bazel&rsquo;s remote execution features. We have chosen to run our own build farm service for resource governance and security purposes, but also because the behavior of this system impacts the developer experience so directly that we want to have full in-house control and knowledge of it.</p><p>Things haven&rsquo;t been smooth-sailing though. While the initial deployment was simple, resource provisioning, performance tuning, and stability have been a struggle. Folks in the Build Barn community advised us to over-provision the cache and the worker pool&mdash;and we did&mdash;but such advice didn&rsquo;t sound quite right: we had already invested as many resources in the build farm as we were using for our legacy builds, yet the Bazel builds couldn&rsquo;t keep up with the load.</p><p>All combined, this was not a great story: users saw builds failing and we didn&rsquo;t have a good grasp about what was going on. Until&mldr; we could <em>see</em> into the build farm behavior. As soon as we had pictures, the source of these problems became obvious. Let&rsquo;s take a peek at what problems we had, how visualizations helped us diagnose them, and what solutions we applied.</p><h1 id=initial-setup>Initial setup</h1><p>When we deployed Build Barn at the beginning of the year in an in-house Kubernetes cluster, we didn&rsquo;t put much thought into resource provisioning because our needs were modest. As we made progress through the migration, and as soon as we had the main product and its tests building with Bazel, we had to set up required Bazel build validation within our Continuous Integration (CI) system to minimize the chances of build regressions. This increased the load on the build farm as well as its reliability expectations.</p><p>Unfortunately, these led us to infrastructure problems. When those happened, all indicators pointed at issues in the build farm&rsquo;s shared cache nodes. We didn&rsquo;t have many metrics in place yet, but the few we had told us that the cache wasn&rsquo;t keeping up in size or in performance, and we saw significant action queuing. Our reaction was to address the seemingly-obvious cause: the shared cache nodes were backed by slow EBS devices, so we moved them to locally-attached NVMe flash drives. Surprisingly though, this made little difference in overall performance.</p><p>Why? Why was it that the build farm could not keep up under load?</p><h1 id=profiling>Profiling</h1><p>My own hypothesis was that our cache nodes were starved of network. This was based on the observation that we have relatively few of them serving hundreds of workers and clients, and that the pathological workloads that brought us to the outages involved very large artifacts staged on many workers. We had no good data to prove this because we hadn&rsquo;t yet added enough instrumentation to find a smoking gun, and the few metrics we had didn&rsquo;t implicate the network.</p><p>Resolving this issue was in our critical path to complete the Bazel migration so I was determined to get a better understanding of it. Two previous bits of knowledge helped reach a solution: past experience with <a href=https://tools.bsc.es/paraver>Paraver</a>, a cluster-level trace visualization tool to observe execution behavior across machines, and the <a href=https://bazel.build/advanced/performance/json-trace-profile>trace profile that Bazel emits</a>, which looks strikingly similar but is <a href=https://www.chromium.org/developers/how-tos/trace-event-profiling-tool/>opened via Chrome</a>.</p><p>I spent a couple of hours prototyping a Python script that queries the database into which we dump build farm events, fetches action scheduling details during a time period, and turns those into a Chrome trace. The idea here was to show, for each worker node in the cluster, what each of its execution threads was doing. That is, I was interested in seeing whether each thread was:</p><ol><li><strong>idle</strong>,</li><li><strong>downloading</strong> input artifacts from the shared cache,</li><li><strong>executing</strong> an action,</li><li>or <strong>uploading</strong> output artifacts to the shared cache.</li></ol><p>Here is one of the first pictures I obtained for a time period where we observed significant action queuing and thus build farm performance degradation:</p><figure><img src=/images/2023-10-20-old-farm-io-issues-trace.png class=with-border><figcaption>2023-09-13 17:40–18:15 UTC: The X axis shows time and the Y axis shows worker nodes / thread pairs. In the Y axis you can see gray bars with the worker names, each grouping 8 execution threads. Then, for each worker node / thread pair, there are two horizontal colored bars: the bar at the top indicates the name of the action that’s currently running on the execution thread, and the bar at the bottom provides a breakdown of the download, execution, and upload phases.</figcaption></figure><p>You can click to zoom into the picture, but the key thing to notice is this: orange corresponds to download/upload whereas green corresponds to execution. And the majority of the picture is orange.</p><p>This was the first indication that we truly had networking problems as I originally set out to prove. But while this visualization is really powerful to pinpoint the issue, it&rsquo;s hard to quantify it. So I performed other computations and found that, for this period of time, workers were 97% utilized yet&mldr; they were only executing actions 20% of the time. A whopping 77% of the time was being lost to the network.</p><p>Or, shown another way: if we graph the different phases per second, we get this graph:</p><figure><img src=/images/2023-10-20-old-farm-io-issues-chart.png class=with-border><figcaption>2023–09–13 17:40–18:15 UTC: Tally of where build farm processing time goes during the first 100 seconds of this time window. For each second, we can see what percentage of the time is spent in each phase.</figcaption></figure><p>Much easier to see the problem and much easier to see that the networking overheads are constant over time.</p><h1 id=was-it-the-network-though>Was it the network though?</h1><p>So far, everything pointed at the network being the problem. But then, I looked at different time periods when the cluster wasn&rsquo;t experiencing queuing and I also looked at the staging cluster which barely had any traffic. And, surprise, <em>all of them</em> showed the same profile: no matter how busy a cluster was, the workers were only able to execute actions for about 2/3rds of their time.</p><p>This made no sense. If the problems were with the network, and the assumption was that the cache nodes were starved of network bandwidth, we should only see this behavior during high traffic. Without extra visibility into network metrics, which we didn&rsquo;t have, I was out of ideas, so I did what I always do: write.</p><p>I collected my thoughts into a shared document and shared it with the team. Almost accidentally, a teammate left a comment saying that the workers were using EBS for their scratch disk space. This was the <em>aha moment</em> we needed: based on previous experience running Bazel on VMs backed by EBS, we knew that EBS&rsquo; IOPS were insufficient for the high demands of a build, and the same likely applied to the workers.</p><p>This theory made immediate sense to the team too, so we proceeded to reconfigure our staging cluster with tmpfs for the workers&rsquo; scratch disk space instead of EBS. While RAM-hungry, tmpfs would provide us with the best-case performance scenario. If the experiment succeeded, we could later re-analyze whether we wanted to keep using RAM or to find another VM SKU type with a local disk to cut costs.</p><p>We rolled out the change to staging and it looked very promising: our reduced collection of workers showed that the fetch and upload phases went to almost zero.</p><h1 id=scheduler-woes>Scheduler woes</h1><p>But here is what happened after we rolled this out to production because, even with the tmpfs fix, we observed <em>another</em> queuing outage:</p><figure><img src=/images/2023-10-20-new-farm-scheduler-issues-trace.png class=with-border><figcaption>2023-10-02 21:00–22:00: Trace view. Same description as before.</figcaption></figure><p>There was queuing but the cluster was&mldr; almost idle? Metrics said the workers&rsquo; overall utilization was 14% of which 12% was execution. Put another way:</p><figure><img src=/images/2023-10-20-new-farm-scheduler-issues-chart.png class=with-border><figcaption>2023-10-02 21:00–22:00: Phase breakdown during the first 100 seconds.</figcaption></figure><p>As you can see in both pictures, the cluster showed almost no activity. We had significant queuing but the cluster was mostly idle. It was great to see that the fetch and upload bands had almost disappeared, but now the workers were not being utilized.</p><p>Answering this piece of the puzzle was easier. If the workers weren&rsquo;t receiving enough work to do, we had problems either in the job scheduler or in the frontends. Fortunately, we <em>did</em> have metrics on the CPU consumption of these actors of the system and they showed a clear problem: the scheduler had an allocation of 0.3 CPUs and it was maxed out.</p><p>Now&mldr; 0.3 CPUs?! Yes, that was ridiculously low: when provisioning a distributed system, if you have a singleton job, you&rsquo;ll want to over-provision it just in case because, in the grand scheme of things, the cost will be negligible. But we had a low reservation, probably because of a copy/pasted configuration from months ago that we had no reason to revisit.</p><p>We had to revisit this CPU allocation now. We gave the scheduler more CPU and more RAM and waited for the next burst of activity.</p><h1 id=stunning-performance>Stunning performance</h1><p>Here is what we saw after bumping up the scheduler CPU and RAM reservations during another busy time period:</p><figure><img src=/images/2023-10-20-new-farm-good-trace.png class=with-border><figcaption>2023-10-03 23:57–23:59: Trace view. Same description as before.</figcaption></figure><p>Notice the green bars? Or rather&mldr; the lack of orange bars? That&rsquo;s right. The workers were now 99% utilized with 97% of their time going into execution. And if we look into the other view of this same data:</p><figure><img src=/images/2023-10-20-new-farm-good-chart.png class=with-border><figcaption>2023-10-03 23:57–23:59: Phase breakdown during the first 100 seconds.</figcaption></figure><p>We can also see a sea of green with almost no network transfers and no idle time during busy periods. Problem(s) solved.</p><p>Our build farm can now support roughly 3x the load that it ran before. Disk-intensive tests are now as fast as when they run on a local development environment. And incremental builds are faster because of reduced end-to-end action execution times. But we aren&rsquo;t done yet! While the system is now performing well, there are additional tuning operations we must do to improve the reliability of the system, to minimize hiccups during maintenance periods, and to reduce the overall monetary cost.</p><h1 id=takeaways>Takeaways</h1><p>Here are my takeaways from this exercise:</p><ol><li>Visualizations are an incredibly powerful tool to understand a distributed system. You can have all the metrics and time series you want about individual performance indicators, but unless you can tie them together and give them meaning, you&rsquo;ll likely not understand what&rsquo;s going on. In our case, the trace visualizations enlightened us almost immediately once we could see them.</li><li>Hypotheses are great to guide investigations, but measurements are crucial to come out with the correct root causes. In this case, I started with the assumption that we had problems in the cache nodes due to network starvation, and while we did end up finding network issues, they were in a completely different part of the system.</li><li>Investing time into learning the metrics that your team&rsquo;s telemetry collects is one of the best things you can do during onboarding. For me, this is the third time I join a team and postpone learning the schema and the queries needed to make sense of the data that the team collected, and I&rsquo;ve regretted the delay every time. You can solve a ton of problems by just knowing where and how to look at existing data; stopping to learn these will pay dividends quickly.</li><li>Developer productivity is an exciting area to work on. Don&rsquo;t get fooled by folks or even companies that treat build engineers as second-class citizens. Developer productivity is a really broad area of engineering that covers everything from single-machine kernel-level tuning to distributed systems troubleshooting, while also interacting with (internal) customers and creating delightful user interfaces.</li></ol><p>Sounds like the kind of thing you&rsquo;d like to work on? <a href="https://careers.snowflake.com/us/en/search-results?keywords=developer+productivity">Join our team!</a> 🙂</p></article></div></div><div class="container post-links"><div class=row><div class="col mr-auto text-left"><span><a href=https://jmmv.dev/2023/10/unit-testing-with-shtk.html>&#171; Previous</a></span></div><div class="col text-center"><span><a href=/archive.html>All posts</a></span></div><div class="col ml-auto text-right"><span><a href=https://jmmv.dev/2023/10/hello-blog-system5.html>Next &#187;</a></span></div></div></div><div class="container post-votes"><div class=row><div class="col-lg-4 my-2"><div class=row><div class=col><a onclick=voteThumbsUp() class="btn btn-block btn-outline-success" id=thumbs-up-btn>👍
(<span id=thumbs-up-count>0</span>)</a></div><div class=col><a onclick=voteThumbsDown() class="btn btn-block btn-outline-danger" id=thumbs-down-btn>👎
(<span id=thumbs-down-count>0</span>)</a></div></div></div><div class="col-lg-8 my-2 d-none d-sm-block"><div class=row><div class="col-md-4 text-center"><a href="https://www.reddit.com/submit?title=Build+farm+visualizations&amp;url=https%3A%2F%2Fjmmv.dev%2F2023%2F10%2Fbuild-farm-visualizations.html" class="btn btn-block btn-outline-primary">Share on
<img src=/images/badges/reddit.png alt=Reddit width=24 height=24></a></div><div class="col-md-4 text-center"><a href="https://news.ycombinator.com/submitlink?t=Build+farm+visualizations&amp;u=https%3A%2F%2Fjmmv.dev%2F2023%2F10%2Fbuild-farm-visualizations.html" class="btn btn-block btn-outline-primary">Share on
<img src=/images/badges/ycombinator.png alt="Hacker News" width=24 height=24></a></div><div class="col-md-4 text-center"><a href="https://twitter.com/intent/tweet?status=Build+farm+visualizations+%E2%80%94+https%3A%2F%2Fjmmv.dev%2F2023%2F10%2Fbuild-farm-visualizations.html+%E2%80%94+cc+%40jmmv" class="btn btn-block btn-outline-primary">Share on
<img src=/images/badges/Twitter_Social_Icon_Circle_Color.png alt=Twitter width=24 height=24></a></div></div></div></div><div class="row my-4" id=postCommentRow><div class=col><div class=media><img class=mr-3 src=/octicons/pencil.svg width=32px height=32px><div class="media-body container"><form method=post id=newPost><div class=row><div class="col my-1"><textarea class=form-control rows=1 id=postCommentContent onclick=showPostComment() placeholder="Leave a comment"></textarea></div></div><div class="row newPostControls" style=display:none><div class="col my-1 form-group"><label for=postCommentAuthor>Your name (optional):</label>
<input type=text class=form-control id=postCommentAuthor></div></div><div class="row newPostControls" style=display:none><div class="col my-1 form-group"><label for=postCommentEmail>Your email (optional):</label>
<input type=text class=form-control type=email id=postCommentEmail>
<small class="form-text text-muted">Invisible to all readers; if provided, you will receive notifications when replied to (not implemented yet)</small></div></div><div class=row id=postCommentError style=display:none><div class="col mt-1 alert-danger"><p></p></div></div><div class="row newPostControls" style=display:none><button class="col-md-3 my-1 btn btn-primary" type=submit id=submitCommentButton>Post</button>
<small class="col-md-9 my-1 text-muted">Comments are subject to moderation. This feature is experimental and is powered by <a href=/software/endtracker.html>EndTRACKER</a>. If you experience any issues, please <a href=/about.html#contact>contact me off-band</a>.</small></div></form></div></div></div></div><script>function hidePostComment(){var t,e=document.getElementById("postCommentContent");e.rows=1,e.value="",t=document.getElementsByClassName("newPostControls"),Array.prototype.forEach.call(t,function(e){e.style.display="none"})}function showPostComment(){var e,t=document.getElementById("postCommentContent");t.rows=5,e=document.getElementsByClassName("newPostControls"),Array.prototype.forEach.call(e,function(e){e.style.display=""})}const form=document.querySelector("#newPost");form.onsubmit=function(e){e.preventDefault();let t=document.getElementById("postCommentAuthor").value,n=document.getElementById("postCommentEmail").value,s=document.getElementById("postCommentContent").value;postComment(t,n,s,hidePostComment)}</script></div></div><div class="col-md-3 sidebar d-none d-md-block"><div class=row><div class="col text-center p-2"><p><a href=/about.html class=clear-link><img src=/images/avatars/20181124-snow.jpg class="rounded-circle shadow my-2" style=width:100px><br><b>Julio Merino</b><br>A blog on operating systems, programming languages, testing, build systems, my own software
projects and even personal productivity. Specifics include FreeBSD, Linux, Rust, Bazel and
EndBASIC.</a></p><div class=row><div class=col><div class=form-group><form action=https://endtracker.azurewebsites.net/api/sites/e8da9f62-b7ac-4fe9-bf20-7c527199a376/subscribers/add method=post><input type=text name=email placeholder="Enter your email" class="form-control input-sm text-center my-1">
<button type=submit class="btn btn-primary btn-block my-1">Subscribe</button></form></div></div></div><div class="row px-2"><div class="col-sm-5 text-left"><small><span class=subscriber-count>0</span> subscribers</small></div><div class="col-sm-7 text-right"><p><a rel=me href=https://mastodon.online/@jmmv><img src=/images/badges/mastodon-logo.svg width=32px height=32px alt="Follow @jmmv on Mastodon">
</a><a href="https://twitter.com/intent/follow?original_referer=https%3A%2F%2Fjmmv.dev%2F&amp;screen_name=jmmv"><img src=/images/badges/Twitter_logo_blue.svg width=32px height=32px alt="Follow @jmmv on Twitter">
</a><a href=/feed.xml><img src=/images/badges/feed-icon-28x28.png alt="RSS feed"></a></p></div></div></div></div><div class=row><div class=col><h2>Featured software</h2><ul><li class=overflow-ellipsis><a href=https://www.endbasic.dev/ target=_blank>EndBASIC: Online BASIC+DOS env</a></li><li class=overflow-ellipsis><a href=https://endtracker.azurewebsites.net/ target=_blank>EndTRACKER: Services for static sites</a></li></ul></div></div><div class=row><div class=col><h2>Featured posts</h2><ul><li class=overflow-ellipsis><a href=/2023/06/fast-machines-slow-machines.html>Fast machines, slow machines</a></li><li class=overflow-ellipsis><a href=/2022/12/endbasic-0.10.html>EndBASIC 0.10: Core language, evolved</a></li><li class=overflow-ellipsis><a href=/2022/10/bye-microsoft-hi-snowflake.html>Farewell, Microsoft; hello, Snowflake!</a></li><li class=overflow-ellipsis><a href=/2022/05/rust-is-hard-but-does-it-matter.html>Rust is hard, yes, but does it matter?</a></li><li class=overflow-ellipsis><a href=/2022/04/rust-traits-and-dependency-injection.html>Rust traits and dependency injection</a></li><li class=overflow-ellipsis><a href=/2022/03/a-year-on-windows-intro.html>A year on Windows: Introduction</a></li><li class=overflow-ellipsis><a href=/2021/04/always-be-quitting.html>Always be quitting</a></li><li class=overflow-ellipsis><a href=/2021/02/google-monorepos-and-caching.html>How does Google keep build times low?</a></li><li class=overflow-ellipsis><a href=/2020/12/google-no-clean-builds.html>How does Google avoid clean builds?</a></li><li class=overflow-ellipsis><a href=/2020/12/unit-testing-a-console-app.html>Unit-testing a console app (a text editor)</a></li><li class=overflow-ellipsis><a href=/essays.html#featured>More...</a></li></ul></div></div></div></div></div><footer class=container-fluid><div class=row><div class="col-4 order-2 text-right"><p class=float-right><a href=#>Back to top</a></p></div><div class="col-8 order-1 mr-auto"><p>Copyright 2004&ndash;2025
Julio Merino</p></div></div></footer><script type=module>
  import { addAnchorsToHeaders, addElementClasses, BatchClient } from "\/js\/main.0de73782e9e0fbcb4184fb5793949b3b0d0ada16455df89320415b4dcc052f88.js";

  var batchClient = new BatchClient(SITE_ID);
  batchClient.doAll({
    put_request: true, get_comments: true, get_subscriber_count: true, get_votes: true });

  window.voteThumbsUp = function() { batchClient.voteThumbsUp(); }
  window.voteThumbsDown = function() { batchClient.voteThumbsDown(); }

  window.postComment = function(...args) {
    batchClient.postComment(...args);
  };

  addAnchorsToHeaders();
  addElementClasses();
</script><noscript><img src="https://hugo-dynamic.jmmv.dev/api/sites/e8da9f62-b7ac-4fe9-bf20-7c527199a376/pages/aHR0cHM6Ly9qbW12LmRldi8yMDIzLzEwL2J1aWxkLWZhcm0tdmlzdWFsaXphdGlvbnMuaHRtbA==/stamp.gif" style=display:none></noscript></body></html>