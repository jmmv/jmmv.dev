<!DOCTYPE html>
<html>
  <head>
    

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- The above 3 meta tags *must* come first in the head; any other head
      content must come *after* these tags -->

<meta name="description"
      content="Are you looking for a method to merge multiple Git repositories into asingle one? If so, you have reached the right tutorial!">
<meta name="author" content="Julio Merino">

<meta content="http://julio.meroh.net/2014/02/how-to-merge-multiple-git-repositories.html" property="og:url">

<link rel="canonical" href="http://julio.meroh.net/2014/02/how-to-merge-multiple-git-repositories.html">
<link rel="alternate" type="application/rss+xml" title="Julio Merino" href="http://julio.meroh.net/feed.xml" />

<link rel="stylesheet" href="/css/main.css">

<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="/js/html5shiv-3.7.2.min.js"></script>
  <script src="/js/respond-1.4.2.min.js"></script>
<![endif]-->

    <title>How to merge multiple Git repositories into one - Julio Merino</title>
    <meta content="How to merge multiple Git repositories into one - Julio Merino" property="og:title">
  </head>

  <body>
    <header class="site-header">

<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed"
              data-toggle="collapse" data-target="#navbar"
              aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Julio Merino</a>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
          
            
              
                <li><a class="page-link"
                href="/about/"
                >About</a></li>
              
            
          
        
          
            
          
        
          
            
          
        
          
            
              
                <li><a class="page-link"
                href="/essays/"
                >Essays</a></li>
              
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
              
                <li><a class="page-link"
                href="/software/"
                >Software</a></li>
              
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
              
                <li><a class="page-link"
                href="/work/"
                >Work</a></li>
              
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
      </ul>

      <form class="navbar-form navbar-right" method="get" role="search"
            action="http://www.google.com/search">
          <div class="form-group">
            <input type="text" name="query" class="form-control"
                   placeholder="Search">
            <input type="hidden" name="sitesearch" value="http://julio.meroh.net">
          </div>
          <button type="submit" value="Search" class="btn btn-default">
            <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
          </button>
      </form>
    </div>
  </div>
</nav>

</header>


    <div class="page-header">
      <div class="container">
        <h1>How to merge multiple Git repositories into one</h1>

        <p><!-- From http://alanwsmith.com/jekyll-liquid-date-formatting-examples -->

February

15th,
  
2014
at
16:08 
        
        </p>

        
      </div>
    </div>

    <div class="container">
      <article>
        <p>Are you looking for a method to merge multiple Git repositories into a
single one? If so, you have reached the right tutorial!</p>

<p>Please bear with me for a second while I provide you with background
information and introduce the subject of our experiments. We’ll get to
the actual procedure soon and you will be able to apply it to any
repository of your choice.</p>

<hr />

<p>In the <a href="http://code.google.com/p/kyua/">Kyua project</a>, and with the
introduction of the <code class="highlighter-rouge">kyua-atf-compat</code> component in the Summer of 2012, I
decided to create independent Git repositories for each component. The
rationale was that, because each component would be shipped as a
standalone distfile, they ought to live in their own repositories.</p>

<p>Unfortunately, this approach is turning out to be a bit of an
inconvenience: it is annoying to manage various repositories when the
code of them all is supposed to be used in unison; it is hard to apply
changes that cross component boundaries; and it is “impossible” to reuse
code among the various components (e.g. share autoconf macros) in a
clean manner — much less attempt to share the version number between
them all.</p>

<p>So what if all components lived in the same repository a la BSD but were
still shipped as individual, fine-grained tarballs for packaging’s sake?
Let’s investigate.</p>

<h1 id="the-goal">The goal</h1>

<p>Obviously, the goal is to get two or more Git repositories and merge
them together. It’s particularly important to not mangle any existing
commit IDs nor tags so that history is preserved intact.</p>

<p>For the specifics of our example, Kyua has three repositories: one for
<code class="highlighter-rouge">kyua-cli</code> (which is the default, unqualified repository in Google
Code), one for <code class="highlighter-rouge">kyua-atf-compat</code> and one for <code class="highlighter-rouge">kyua-testers</code>. The idea is
to end up with a single repository that contains three top-level
directories, one for each component, and all independent of each other
(at least initially).</p>

<h1 id="process-outline">Process outline</h1>

<p>The key idea to merge Git repositories is the following:</p>

<ol>
  <li>Select a repository to act as pivot. This is the one into which you
will merge all others.</li>
  <li>Move the contents of the pivot repository into a single
top-level directory.</li>
  <li>Set up a new remote for the secondary repository to be merged.</li>
  <li>Fetch the new remote and check it out into a new local branch.</li>
  <li>Move the contents of the secondary repository into a single
top-level directory.</li>
  <li>Check out the master branch.</li>
  <li>Merge the branch for the secondary repository.</li>
  <li>Repeat from 3 for any additional repository to be merged.</li>
</ol>

<h1 id="sounds-good-lets-get-down-to-the-surgery">Sounds good? Let’s get down to the surgery!</h1>

<p>We need to select a pivot. For Kyua, this will be the default Google
Code repository in <a href="https://code.google.com/p/kyua">https://code.google.com/p/kyua</a>. Let’s start by
checking it out and moving all of its contents into a subdirectory:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ git clone https://code.google.com/p/kyua
$ cd kyua
$ mkdir kyua-cli
$ git mv * kyua-cli
$ git commit -a -m "Move."
</code></pre>
</div>

<p>We are ready to start tackling the merge of a secondary repository. I
will use <a href="https://code.google.com/p/kyua.testers">https://code.google.com/p/kyua.testers</a> in this example.</p>

<p>The first step is to pull in that secondary repository into our pivot:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ git remote add origin-testers https://code.google.com/p/kyua.testers
$ git fetch origin-testers
</code></pre>
</div>

<p>And now, check it out into a temporary branch and move all of its
contents into a subdirectory:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ git branch merge-testers origin-testers/master
$ mkdir kyua-testers
$ git mv * kyua-testers
$ git commit -a -m "Move."
</code></pre>
</div>

<p>Done? It’s the time to merge the two repositories into one!</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ git checkout master
$ git merge merge-testers
</code></pre>
</div>

<p>And clean some stuff up.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ git branch -d merge-testers
$ git remote remove origin-testers
</code></pre>
</div>

<p>Voilà. It wasn’t that hard, was it? Just repeat the steps above for any
other secondary repository you would like to merge.</p>

<h1 id="parting-words">Parting words</h1>

<p>Note that this procedure achieves the goal of preserving the history of
all individual repositories, the revision numbers and the tags. In other
words: all previous history is left intact and all commit logs remain
valid after the merge.</p>

<p>Do you know if there is any easier way of doing this? Would it have any
differences in the actual results?</p>

<p>What do you think about doing the merge for Kyua? I see this as a
prerequisite for the migration to GitHub.</p>

      </article>

      <div class="post-links">
        <p>
          

          

          <a href="/feed.xml">Subscribe
          via RSS</a>
          &middot;
          <a href="/blog/">Go to posts index</a>
        </p>

        <form class="form-inline"
            action="https://feedburner.google.com/fb/a/mailverify"
            method="post"
            target="popupwindow"
            onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=jmmv', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
          <div class="form-group form-group-sm">
            <input type="text" style="width: 400px" name="email"
                    placeholder="Enter your email to subscribe to new posts"
                    class="form-control input-sm"/>
          </div>
          <button type="submit" value="Subscribe"
                  class="btn btn-default btn-sm">
            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
          </button>
          &nbsp;&nbsp;&nbsp;Delivered by
          <input type="hidden" value="jmmv" name="uri"/>
          <input type="hidden" name="loc" value="en_US"/>
          <a href="https://feedburner.google.com" target="_blank">FeedBurner</a>
        </form>
      </div>

      
      <div id="disqus_thread">
        <script>
          var disqus_config = function () {
            this.page.url = "http://julio.meroh.net/2014/02/how-to-merge-multiple-git-repositories.html";
            this.page.identifier = "/2014/02/how-to-merge-multiple-git-repositories";
          };
          (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');

            s.src = '//jmmv.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
        <noscript>Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments
          powered by Disqus.</a>
        </noscript>
      </div>
      
      <p>Comments from the original Blogger-hosted post:</p>
      <script src="https://apis.google.com/js/plusone.js"></script>
      <div class="g-comments"
           data-href="http://julipedia.meroh.net/2014/02/how-to-merge-multiple-git-repositories.html"
           data-first_party_property="BLOGGER"
           data-view_type="FILTERED_POSTMOD">
      </div>
      
      
    </div>

    <div class="container">
  <footer>
    <p class="pull-right"><a href="#">Back to top</a></p>
    <p>Copyright 2016 Julio Merino</p>
  </footer>
</div>

<script src="/js/jquery-1.11.2.min.js">
</script>
<script
  src="/css/bootstrap.min.js">
</script>

<script src="/js/auto-toc-1.0.0.dist.js">
</script>

<script>
$("p:contains('NOTE: ')").addClass("callout callout-info");
$("p:contains('IMPORTANT: ')").addClass("callout callout-info");
$("p:contains('WARNING: ')").addClass("callout callout-warning");
$("p:contains('DANGER: ')").addClass("callout callout-danger");
</script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
  m.parentNode.insertBefore(a,m)})(window,document,'script',
  '//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63557333-1', 'auto');
  ga('send', 'pageview');
</script>


  </body>
</html>
