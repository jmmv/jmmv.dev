<!doctype html><html lang=en xmlns=http://www.w3.org/1999/xhtml xmlns:fb=http://ogp.me/ns/fb#><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta property="og:site_name" content="Julio Merino (jmmv.dev)"><meta property="twitter:site" content="@jmmv"><title>A year on Windows: System debugging - Julio Merino (jmmv.dev)</title><meta property="og:title" content="A year on Windows: System debugging - Julio Merino (jmmv.dev)"><meta property="twitter:title" content="A year on Windows: System debugging - Julio Merino (jmmv.dev)"><meta name=description content="As you are well-aware, Windows is a closed-source operating system. That, however, does not mean that it is opaque. In fact, it feels quite the opposite in many areas, which might be a surprise to you&amp;mdash;especially if you develop on/for open-source operating systems.
"><meta property="og:description" content="As you are well-aware, Windows is a closed-source operating system. That, however, does not mean that it is opaque. In fact, it feels quite the opposite in many areas, which might be a surprise to you&amp;mdash;especially if you develop on/for open-source operating systems.
"><meta property="twitter:description" content="As you are well-aware, Windows is a closed-source operating system. That, however, does not mean that it is opaque. In fact, it feels quite the opposite in many areas, which might be a surprise to ‚Ä¶"><meta name=author content="Julio Merino"><meta property="twitter:creator" content="@jmmv"><meta name=generator content="Hugo 0.111.3"><meta property="og:url" content="https://jmmv.dev/2022/03/a-year-on-windows-debugging.html"><meta property="og:type" content="blog"><meta property="twitter:card" content="summary"><link rel=canonical href=https://jmmv.dev/2022/03/a-year-on-windows-debugging.html><link rel=alternate type=application/rss+xml title="Julio Merino (jmmv.dev)" href=/feed.xml><link rel=stylesheet href=/sass/main.min.161663676cac4bf21abc8967ec3267c26026aa58e9f392c5f3427e0ef089fe6b.css><link rel=stylesheet href=/css/chroma.css><link rel=icon type=image/png href=/images/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/images/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicons/favicon-96x96.png sizes=96x96><meta property="og:image" content="/images/favicons/favicon-1200x1200.png"><meta property="twitter:image" content="https://jmmv.dev/images/favicons/favicon-1200x1200.png"><script>const SITE_ID="e8da9f62-b7ac-4fe9-bf20-7c527199a376",BASE_URL="https://jmmv.dev/"</script></head><body><header class=site-header><nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-primary"><a class=navbar-brand href=/><img src=/images/favicons/favicon-30x30.png width=30 height=30 class="d-inline-block align-top" alt>
&nbsp;Julio Merino</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=/about.html>About</a></li><li class=nav-item><a class=nav-link href=/essays.html>Essays</a></li><li class=nav-item><a class=nav-link href=/resume.html>Resume</a></li><li class=nav-item><a class=nav-link href=/software.html>Software</a></li></ul><ul class="navbar-nav mr-4"><li class=nav-item><a class=nav-link href=/archive.html>Archive</a></li><li class=nav-item><a class=nav-link href=/series.html>Series</a></li><li class=nav-item><a class=nav-link href=/tags.html>Tags</a></li></ul><form class=form-inline method=get role=search action=https://www.google.com/search><div class=input-group><input type=search name=query class=form-control placeholder=Search aria-label=Search><div class=input-group-append><button type=submit value=Search class="btn btn-light">
<img src=/octicons/search.svg></button></div></div><input type=hidden name=sitesearch value=https://jmmv.dev/></form></div></nav></header><div class=page-header><div class=container><h1>A year on Windows: System debugging</h1><p>March 17, 2022 &#183;
About 5 minutes
&#183;
Tags:
<a href=/tags/windows>windows</a></p><p class=post-meta-p>This article is part number
11 of 13 of the
<a href=/series.html#A%20year%20on%20Windows><b>A year on Windows</b></a> series.</p></div></div><div class="container post-body"><div class=row><div class=col-md-9><div class=row><div class=col><article><p>As you are well-aware, Windows is a closed-source operating system. That, however, does <em>not</em> mean that it is <em>opaque</em>. In fact, it feels quite the opposite in many areas, which might be a surprise to you&mdash;especially if you develop on/for open-source operating systems.</p><div class="container action-highlight p-4 my-4 d-md-none"><div class="row text-center"><p>A blog on operating systems, programming languages, testing, build systems, my own software
projects and even personal productivity. Specifics include FreeBSD, Linux, Rust, Bazel and
EndBASIC.</p></div><div class=row><div class=col><div class=form-group><form action=https://endtracker.azurewebsites.net/api/sites/e8da9f62-b7ac-4fe9-bf20-7c527199a376/subscribers/add method=post><input type=text name=email placeholder="Enter your email" class="form-control input-sm text-center my-1">
<button type=submit class="btn btn-primary btn-block my-1">Subscribe</button></form></div></div></div><div class="row px-2"><div class="col col-sm-5 text-left"><small><span class=subscriber-count>0</span> subscribers</small></div><div class="col col-sm-7 text-right"><p><a rel=me href=https://mastodon.online/@jmmv><img src=/images/badges/mastodon-logo.svg width=32px height=32px alt="Follow @jmmv on Mastodon"></a>
<a href="https://twitter.com/intent/follow?original_referer=https%3A%2F%2Fjmmv.dev%2F&amp;screen_name=jmmv"><img src=/images/badges/Twitter_logo_blue.svg width=32px height=32px alt="Follow @jmmv on Twitter"></a>
<a href=/feed.xml><img src=/images/badges/feed-icon-28x28.png alt="RSS feed"></a></p></div></div></div><p>To understand why that might be, put yourself in the shoes of a Windows engineer and consider how Windows must be extensible in various ways: kernel-level drivers, File Manager extensions, PowerShell cmdlets&mldr; you name it. If you start with the premise that you must support these scenarios from a closed-source OS, you will have to design the product in ways that are not common in open source systems. For example:</p><ul><li>Supporting loadable binary plugins will be a requirement for extensibility because people can&rsquo;t just edit the code.</li><li>Having clear API documentation will be a must because people won&rsquo;t be able guess what calls are available and how they behave from their implementation.</li><li>Having backwards binary compatibility will be important because users won&rsquo;t be able to recompile whichever piece of software they are using against newer versions of the system.</li></ul><p>Take drivers as a thought exercise. Drivers are a gnarly thing to develop because they run inside the kernel, interact directly with the hardware <em>and</em> the kernel&rsquo;s interfaces, and any error in kernel-level cannot be easily debugged from userland. Or can it? I&rsquo;ve been reading through the &ldquo;<a href=https://www.amazon.com/Advanced-Windows-Debugging-Mario-Hewardt/dp/0321374460>Advanced Windows Debugging</a>&rdquo; and &ldquo;<a href=https://www.microsoftpressstore.com/store/windows-internals-9780735625303>Windows Internals, 5th edition</a>&rdquo; books (haven&rsquo;t made it very far in either though) and it&rsquo;s <em>impressive</em> how much you can learn about the system without actually having its source code.</p><p>Speaking of debugging and internals, one thing that &ldquo;shocked&rdquo; me when joining Microsoft is how much emphasis is put on using a debugger and how incredibly good some people are at debugging extremely subtle bugs purely from a crash dump. At Google, using a debugger was quite a rarity! And it&rsquo;s equally impressive how good the debugging features are: <a href=https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/time-travel-debugging-overview>Time Travel Debugging</a> is mind-blowing.</p><h1 id=the-open-source-approach>The open source approach</h1><p>I can&rsquo;t avoid but compare this to Linux or any of the BSDs. I don&rsquo;t think any of these systems reach this level of&mldr; integrability? I know it sounds like a strange thing to say, but relying on their source code for interoperability purposes is both a blessing and a curse.</p><p>It is a blessing because these systems can be simpler by assuming that people can &ldquo;just edit the source and recompile&rdquo;. But it is a curse <em>because</em> many times you have to recompile things (Nvidia Linux drivers, anyone?) and is what makes it almost impossible to have commercial software running on these platforms. Whether this is a good or bad thing from a &ldquo;freedom&rdquo; perspective is an orthogonal topic.</p><p>Mind you: one of the reasons I liked the BSDs from the very beginning was that they offer an integrated user and development experience (as opposed to Linux), much like Windows did. What I did <em>not</em> like was that I had to recompile everything I wanted to use from scratch, which was and still is fairly problematic on low-powered machines. As an example, I spent a lot of time getting NetBSD to run on an old PowerBook G4 and the only way to do this was by fiddling with compile-time settings for the kernel. It&rsquo;d have been much easier for me (not the developers!) if these settings had been available as runtime boot loader options.</p><p>For a really long time now, I&rsquo;ve been of the opinion that applications should be written <em>as if</em> they were closed-source even if they are actually open-source. The same applies to company-internal applications where you can almost always see the source, and this reminds me of <a href=https://gist.github.com/chitchcock/1281611>Steve Yegge&rsquo;s platform rant</a> (can&rsquo;t find the original now). This is why I spent so much time back in my NetBSD years trying to make the system completely usable and customizable only from binary builds, without having to rebuild anything from scratch (see e.g. <a href=/software/sysupgrade.html>sysupgrade</a> or <a href=/software/pkg_comp.html>pkg_comp</a>). My goal was to have a compiler-less home server, and I was able to do for a long time.</p><h1 id=backwards-compatibility>Backwards compatibility</h1><p>Binary-only interfaces come at a huge cost though. Windows is famously-known for its ~forever backwards compatibility at the binary level, which is great for software vendors but I&rsquo;m sure is cringing (or not, as somebody who has actually done this for a living tells me after reading this!) for anyone having to maintain the internal system interfaces.</p><p>There is this article that made the rounds just yesterday titled <a href=https://gankra.github.io/blah/c-isnt-a-language/>&ldquo;C Isn&rsquo;t A Programming Language Anymore&rdquo;</a> and you should go read at least its <a href=https://gankra.github.io/blah/c-isnt-a-language/#case-study-minidump_handle_data>&ldquo;Case Study: MINIDUMP_HANDLE_DATA&rdquo;</a> section. Or you can also read <a href="https://devblogs.microsoft.com/oldnewthing/20031015-00/?p=42163">one of the many posts</a> by Raymond Chen on how Windows has to deal with backwards compatibility.</p><hr><p>Enough for today. I&rsquo;m sorry I didn&rsquo;t go into details on how exactly Windows is introspectable and debuggable. The reason is, simply, that I don&rsquo;t know enough yet. I mentioned a couple of books earlier on this topic and, while they are very promising&mldr; I have barely had the time to read them. Tomorrow, we have just one more topic to cover before closing the series, and that will be about package management on Windows.</p></article><p class=post-meta-p>This article is part number
11 of 13 of the
<a href=/series.html#A%20year%20on%20Windows><b>A year on Windows</b></a> series.</p></div></div><div class="container post-links"><div class=row><div class="col mr-auto text-left"><span><a href=https://jmmv.dev/2022/03/a-year-on-windows-networked-fs.html>&#171; Previous</a></span></div><div class="col text-center"><span><a href=/archive.html>All posts</a></span></div><div class="col ml-auto text-right"><span><a href=https://jmmv.dev/2022/03/a-year-on-windows-winget.html>Next &#187;</a></span></div></div></div><div class="container post-votes"><div class=row><div class="col-lg-4 my-2"><div class=row><div class=col><a onclick=voteThumbsUp() class="btn btn-block btn-outline-success" id=thumbs-up-btn>üëç
(<span id=thumbs-up-count>0</span>)</a></div><div class=col><a onclick=voteThumbsDown() class="btn btn-block btn-outline-danger" id=thumbs-down-btn>üëé
(<span id=thumbs-down-count>0</span>)</a></div></div></div><div class="col-lg-8 my-2 d-none d-sm-block"><div class=row><div class="col-md-4 text-center"><a href=https://www.reddit.com/r/programming/comments/tgogsw/a_year_on_windows_system_debugging/ class="btn btn-block btn-outline-primary">Go to
<img src=/images/badges/reddit.png alt=Reddit width=24 height=24></a></div><div class="col-md-4 text-center"><a href="https://news.ycombinator.com/submitlink?t=A+year+on+Windows%3A+System+debugging&amp;u=https%3A%2F%2Fjmmv.dev%2F2022%2F03%2Fa-year-on-windows-debugging.html" class="btn btn-block btn-outline-primary">Share on
<img src=/images/badges/ycombinator.png alt="Hacker News" width=24 height=24></a></div><div class="col-md-4 text-center"><a href="https://twitter.com/intent/tweet?status=A+year+on+Windows%3A+System+debugging+%E2%80%94+https%3A%2F%2Fjmmv.dev%2F2022%2F03%2Fa-year-on-windows-debugging.html+%E2%80%94+cc+%40jmmv" class="btn btn-block btn-outline-primary">Share on
<img src=/images/badges/Twitter_Social_Icon_Circle_Color.png alt=Twitter width=24 height=24></a></div></div></div></div><div class="row my-4" id=postCommentRow><div class=col><div class=media><img class=mr-3 src=/octicons/pencil.svg width=32px height=32px><div class="media-body container"><form method=post id=newPost><div class=row><div class="col my-1"><textarea class=form-control rows=1 id=postCommentContent onclick=showPostComment() placeholder="Leave a comment"></textarea></div></div><div class="row newPostControls" style=display:none><div class="col my-1 form-group"><label for=postCommentAuthor>Your name (optional):</label>
<input type=text class=form-control id=postCommentAuthor></div></div><div class="row newPostControls" style=display:none><div class="col my-1 form-group"><label for=postCommentEmail>Your email (optional):</label>
<input type=text class=form-control type=email id=postCommentEmail>
<small class="form-text text-muted">Invisible to all readers; if provided, you will receive notifications when replied to (not implemented yet)</small></div></div><div class=row id=postCommentError style=display:none><div class="col mt-1 alert-danger"><p></p></div></div><div class="row newPostControls" style=display:none><button class="col-md-3 my-1 btn btn-primary" type=submit id=submitCommentButton>Post</button>
<small class="col-md-9 my-1 text-muted">Comments are subject to moderation. This feature is experimental and is powered by <a href=/software/endtracker.html>EndTRACKER</a>. If you experience any issues, please <a href=/about.html#contact>contact me off-band</a>.</small></div></form></div></div></div></div><script>function hidePostComment(){var t,e=document.getElementById("postCommentContent");e.rows=1,e.value="",t=document.getElementsByClassName("newPostControls"),Array.prototype.forEach.call(t,function(e){e.style.display="none"})}function showPostComment(){var e,t=document.getElementById("postCommentContent");t.rows=5,e=document.getElementsByClassName("newPostControls"),Array.prototype.forEach.call(e,function(e){e.style.display=""})}const form=document.querySelector("#newPost");form.onsubmit=function(e){e.preventDefault();let t=document.getElementById("postCommentAuthor").value,n=document.getElementById("postCommentEmail").value,s=document.getElementById("postCommentContent").value;postComment(t,n,s,hidePostComment)}</script></div></div><div class="col-md-3 sidebar d-none d-md-block"><div class=row><div class="col text-center p-2"><p><a href=/about.html class=clear-link><img src=/images/avatars/20181124-snow.jpg class="rounded-circle shadow my-2" style=width:100px><br><b>Julio Merino</b><br>A blog on operating systems, programming languages, testing, build systems, my own software
projects and even personal productivity. Specifics include FreeBSD, Linux, Rust, Bazel and
EndBASIC.</a></p><div class=row><div class=col><div class=form-group><form action=https://endtracker.azurewebsites.net/api/sites/e8da9f62-b7ac-4fe9-bf20-7c527199a376/subscribers/add method=post><input type=text name=email placeholder="Enter your email" class="form-control input-sm text-center my-1">
<button type=submit class="btn btn-primary btn-block my-1">Subscribe</button></form></div></div></div><div class="row px-2"><div class="col-sm-5 text-left"><small><span class=subscriber-count>0</span> subscribers</small></div><div class="col-sm-7 text-right"><p><a rel=me href=https://mastodon.online/@jmmv><img src=/images/badges/mastodon-logo.svg width=32px height=32px alt="Follow @jmmv on Mastodon"></a>
<a href="https://twitter.com/intent/follow?original_referer=https%3A%2F%2Fjmmv.dev%2F&amp;screen_name=jmmv"><img src=/images/badges/Twitter_logo_blue.svg width=32px height=32px alt="Follow @jmmv on Twitter"></a>
<a href=/feed.xml><img src=/images/badges/feed-icon-28x28.png alt="RSS feed"></a></p></div></div></div></div><div class=row><div class=col><h2>Featured software</h2><ul><li class=overflow-ellipsis><a href=https://www.endbasic.dev/ target=_blank>EndBASIC: Online BASIC+DOS env</a></li><li class=overflow-ellipsis><a href=https://endtracker.azurewebsites.net/ target=_blank>EndTRACKER: Services for static sites</a></li></ul></div></div><div class=row><div class=col><h2>Featured posts</h2><ul><li class=overflow-ellipsis><a href=/2023/06/fast-machines-slow-machines.html>Fast machines, slow machines</a></li><li class=overflow-ellipsis><a href=/2022/12/endbasic-0.10.html>EndBASIC 0.10: Core language, evolved</a></li><li class=overflow-ellipsis><a href=/2022/10/bye-microsoft-hi-snowflake.html>Farewell, Microsoft; hello, Snowflake!</a></li><li class=overflow-ellipsis><a href=/2022/05/rust-is-hard-but-does-it-matter.html>Rust is hard, yes, but does it matter?</a></li><li class=overflow-ellipsis><a href=/2022/04/rust-traits-and-dependency-injection.html>Rust traits and dependency injection</a></li><li class=overflow-ellipsis><a href=/2022/03/a-year-on-windows-intro.html>A year on Windows: Introduction</a></li><li class=overflow-ellipsis><a href=/2021/04/always-be-quitting.html>Always be quitting</a></li><li class=overflow-ellipsis><a href=/2021/02/google-monorepos-and-caching.html>How does Google keep build times low?</a></li><li class=overflow-ellipsis><a href=/2020/12/google-no-clean-builds.html>How does Google avoid clean builds?</a></li><li class=overflow-ellipsis><a href=/2020/12/unit-testing-a-console-app.html>Unit-testing a console app (a text editor)</a></li><li class=overflow-ellipsis><a href=/essays.html#featured>More...</a></li></ul></div></div></div></div></div><footer class=container><div class=row><div class="col-4 order-2 texr-right"><p class=float-right><a href=#>Back to top</a></p></div><div class="col-8 order-1 mr-auto"><p>Copyright 2004&ndash;2023 Julio Merino</p></div></div></footer><script type=module>
  import { addAnchorsToHeaders, addElementClasses, BatchClient } from "\/js\/main.d30f168b11d80082408f4a983af9a626c6e57d58f7846b2174bac40d43be33e3.js";

  var batchClient = new BatchClient(SITE_ID);
  batchClient.doAll({
    put_request: true, get_comments: true, get_subscriber_count: true, get_votes: true });

  window.voteThumbsUp = function() { batchClient.voteThumbsUp(); }
  window.voteThumbsDown = function() { batchClient.voteThumbsDown(); }

  window.postComment = function(...args) {
    batchClient.postComment(...args);
  };

  addAnchorsToHeaders();
  addElementClasses();
</script><noscript><img src=https://hugo-dynamic.jmmv.dev/api/sites/e8da9f62-b7ac-4fe9-bf20-7c527199a376/pages/aHR0cHM6Ly9qbW12LmRldi8yMDIyLzAzL2EteWVhci1vbi13aW5kb3dzLWRlYnVnZ2luZy5odG1s/stamp.gif style=display:none></noscript></body></html>