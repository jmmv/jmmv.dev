<!DOCTYPE html>
<html>
  <head>
    

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- The above 3 meta tags *must* come first in the head; any other head
      content must come *after* these tags -->

<meta name="description"
      content="This is Julio Merino's homepage.  This site is primarily my personal blog and, secondarily, a gateway to my presence in the web.
">
<meta name="author" content="Julio Merino">

<meta content="http://julio.meroh.net/page28/" property="og:url">

<link rel="canonical" href="http://julio.meroh.net/page28/">
<link rel="alternate" type="application/rss+xml" title="Julio Merino" href="http://julio.meroh.net/feed.xml" />

<link rel="stylesheet" href="/css/main.css">

<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="/js/html5shiv-3.7.2.min.js"></script>
  <script src="/js/respond-1.4.2.min.js"></script>
<![endif]-->

    <title>Julio Merino</title>
    <meta content="Julio Merino" property="og:title">
  </head>

  <body>
    <header class="site-header">

<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed"
              data-toggle="collapse" data-target="#navbar"
              aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Julio Merino</a>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
          
            
              
                <li><a class="page-link"
                href="/about/"
                >About</a></li>
              
            
          
        
          
            
          
        
          
            
          
        
          
            
              
                <li><a class="page-link"
                href="/essays/"
                >Essays</a></li>
              
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
              
                <li><a class="page-link"
                href="/software/"
                >Software</a></li>
              
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
              
                <li><a class="page-link"
                href="/work/"
                >Work</a></li>
              
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
      </ul>

      <form class="navbar-form navbar-right" method="get" role="search"
            action="http://www.google.com/search">
          <div class="form-group">
            <input type="text" name="query" class="form-control"
                   placeholder="Search">
            <input type="hidden" name="sitesearch" value="http://julio.meroh.net">
          </div>
          <button type="submit" value="Search" class="btn btn-default">
            <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
          </button>
      </form>
    </div>
  </div>
</nav>

</header>


    <!-- We need these to be present early during load so we can avoid hiding
     or showing elements once the page has already been rendered. -->
<script src="/js/jquery-1.11.2.min.js">
</script>
<script src="/js/js.cookie-2.1.1.min.js">
</script>

<script>
  function loadMarketing() {
      var cookie = Cookies.get("marketing-visible");
      if (cookie === undefined || cookie === "true") {
        toggleMarketing(true);
      } else {
        toggleMarketing(false);
      }
  }

  function toggleMarketing(action) {
    if (action) {
      $("#collapse-row").show();
      $("#buttons").show();
      $("#expand-row").hide();
      Cookies.set("marketing-visible", "true", {path: ""});
    } else {
      $("#expand-row").show();
      $("#buttons").hide();
      $("#collapse-row").hide();
      Cookies.set("marketing-visible", "false", {path: ""});
    }
  }
</script>

<div class="page-header">
  <div class="container">
    <h1>Julio Merino</h1>

    <p>Software artist.  Writer aficionado.  Open source enthusiast.
    Runner.  Father of two.<br/>
    <strong>Currently:</strong> Senior Software Engineer at Google,
    New York City.</p>

    <div class="marketing row" style="display: none" id="buttons">
      <div class="col-md-3">
        <a href="/essays/">
          <span class="glyphicon glyphicon-print" aria-hidden="true"></span>
        </a>
        <h2>Author</h2>

        <p>Writer by hobby, typically covering programming topics.
        No fiction.  Find below for the most recent posts or
        open this section for general highlights.</p>
      </div>

      <div class="col-md-3">
        <a href="/software/">
          <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
        </a>
        <h2>Developer</h2>

        <p>Author of various Open Source projects and contributor to many
        more.  BSD enthusiast.  Motto: production software can be
        beautiful.</p>
      </div>

      <div class="col-md-3">
        <a href="/work/">
          <span class="glyphicon glyphicon-briefcase" aria-hidden="true"></span>
        </a>
        <h2>Engineer</h2>

        <p>Senior Software Engineer (and, previously, Senior Site Reliability
        Engineer) at Google in New York City.</p>
      </div>

      <div class="col-md-3">
        <a href="/about/">
          <span class="glyphicon glyphicon-envelope" aria-hidden="true"></span>
        </a>
        <h2>Social</h2>

        <p>Reachable via all the traditional contact mechanisms and the major
        social networks.  See my about page for all the references.</p>
      </div>
    </div>

    <div class="row" style="display: none" id="collapse-row">
      <p class="text-center"><small>
        <a href="javascript:toggleMarketing(false)">
          <span class="glyphicon glyphicon-chevron-up"
                aria-hidden="true"></span>
          Collapse
          <span class="glyphicon glyphicon-chevron-up"
                aria-hidden="true"></span>
        </a>
      </small></p>
    </div>

    <div class="row" style="display: none" id="expand-row">
      <p class="text-center"><small>
        <a href="javascript:toggleMarketing(true)">
          <span class="glyphicon glyphicon-chevron-down"
                aria-hidden="true"></span>
          Expand
          <span class="glyphicon glyphicon-chevron-down"
                aria-hidden="true"></span>
        </a>
      </small></p>
    </div>

    <!-- All the rows above were loaded hidden, so display only the needed
         ones now.  This ensures that we are able to render the page
         sequentially and prevent strange jumps during rendering. -->
    <script>loadMarketing();</script>
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="col-md-9">
      

<ul class="post-list">
  
    <li>
      <h2>
        <a class="post-link" href="/2011/01/error-handling-in-lua-kyua-approach.html">Error handling in Lua: the Kyua approach</a>
      </h2>
      <span class="post-meta"><!-- From http://alanwsmith.com/jekyll-liquid-date-formatting-examples -->

January

14th,
  
2011
at
03:04 
        &middot;
        <a href="/2011/01/error-handling-in-lua-kyua-approach.html#disqus_thread">
          <span class="disqus-comment-count"
                data-disqus-url="http://julio.meroh.net/2011/01/error-handling-in-lua-kyua-approach.html">Comments</span>
        </a>
      </span>
      
      <p>
        About a week ago, I detailed the different approaches I encountered to deal with errors raised by the Lua C API. Later, I announced the new C++ interface for Lua implemented within Kyua. And today, I would like to talk about the specific mechanism I implemented in this library to deal with the Lua errors.The first thing to keep in mind is that the whole purpose of Lua in the context of Kyua is to parse configuration files. This is an infrequent operation, so high performance does not matter: it is more valuable to me to be able to write robust algorithms fast than to have them run at optimal speed. The other key point to consider is that I want Kyua to be able to use prebuilt Lua libraries, which are built as C binaries.The approach I took is to wrap every single unsafe Lua C API call in a "thin" (FSVO thin depending on the case) wrapper that gets called by lua_pcall. Anything that runs inside the wrapper is safe to Lua errors, as they are caught and safely reported to the caller.Lets examine how this works by taking a look at an example: the wrapping of lua_getglobal. We have the following code (copy pasted from the utils/lua/wrap.cpp file but hand-edited for publishing here):static intprotected_getglobal(lua_State* state){    lua_getglobal(state, lua_tostring(state, -1));    return 1;}voidlua::state::get_global(const std::string& name){    lua_pushcfunction(_pimpl->lua_state, protected_getglobal);    lua_pushstring(_pimpl->lua_state, name.c_str());    if (lua_pcall(_pimpl->lua_state, 1, 1, 0) != 0)        throw lua::api_error::from_stack(_pimpl->lua_state,            "lua_getglobal");}The state::get_global method is my public wrapper for the lua_getglobal Lua C API call. This wrapper first prepares the Lua stack by pushing the address of the C function to call and its parameters and then issues a lua_pcall call that executes the C function in a Lua protected environment.In this case, the argument preparation for protected_getglobal is trivial because the lua_getglobal call does not require access to any preexisting values on the Lua stack. Things get much trickier when that happens as in the case of the lua_getglobal wrapper. I'll leave understanding how to do this as an exercise to the reader (but you can cheat by looking at line 154).Anyway. The above looks all very nice and safe and the tests for the state::get_global function, even the ones that intentionally cause a failure, all work fine. So we are good, right? Nope! Unfortunately, the code above is not fully safe to Lua errors.In order to prepare the lua_pcall execution, the code must push values on the stack. As it turns out, both lua_pushcfunction and lua_pushstring can fail if they run out of memory (OOM). Such failure would of course be captured inside a protected environment... but we have a little chicken'n'egg problem here. That said, OOM failures are rare so I'm going to leverage this fact and not worry about it.  (Note to self: install a lua_atpanic handler to complain loudly if that ever happens.)Addendum: Bundling Lua within my program and building it as a C++ binary with exception reporting enabled in luaconf.h would magically solve all my issues. I know. But I don't fancy the idea of bundling the library into my source tree for a variety of reasons.

        <a href="/2011/01/error-handling-in-lua-kyua-approach.html">[Continue reading]</a>
      </p>
      
    </li>
  
    <li>
      <h2>
        <a class="post-link" href="/2011/01/c-interface-to-lua.html">C++ interface to Lua for Kyua</a>
      </h2>
      <span class="post-meta"><!-- From http://alanwsmith.com/jekyll-liquid-date-formatting-examples -->

January

8th,
  
2011
at
08:17 
        &middot;
        <a href="/2011/01/c-interface-to-lua.html#disqus_thread">
          <span class="disqus-comment-count"
                data-disqus-url="http://julio.meroh.net/2011/01/c-interface-to-lua.html">Comments</span>
        </a>
      </span>
      
      <p>
        Finally! After two weeks of holidays work, I have finally been able to submit Kyua's r39: a generic library that implements a C++ interface to Lua. The code is hosted in the utils/lua/ subdirectory.From the revision description:The utils::lua library provides thin C++ wrappers around the Lua C API to ease the interaction between C++ and Lua.  These wrappers make intensive use of RAII to prevent resource leakage, expose C++-friendly data types, report errors by means of exceptions and ensure that the Lua stack is always left untouched in the face of errors.  The library also provides a place (the operations module) to add miscellaneous utility functions built on top of the wrappers.In other words: this code aims to decouple all details of the interaction with the Lua C API from the main code of Kyua so that the high level algorithms do not have to worry about Lua C API idiosyncrasies.Further changes to Kyua to implement the new configuration system will follow soon as all the basic code to talk to Lua has been ironed out. Also expect some extra posts regarding the design decisions that went on this helper code and, in particular, about error reporting as mentioned in the previous post.(Yep, Lua and Kyua sound similar. But that was never intended; promise!)

        <a href="/2011/01/c-interface-to-lua.html">[Continue reading]</a>
      </p>
      
    </li>
  
    <li>
      <h2>
        <a class="post-link" href="/2011/01/error-handling-in-lua.html">Error handling in Lua</a>
      </h2>
      <span class="post-meta"><!-- From http://alanwsmith.com/jekyll-liquid-date-formatting-examples -->

January

7th,
  
2011
at
08:01 
        &middot;
        <a href="/2011/01/error-handling-in-lua.html#disqus_thread">
          <span class="disqus-comment-count"
                data-disqus-url="http://julio.meroh.net/2011/01/error-handling-in-lua.html">Comments</span>
        </a>
      </span>
      
      <p>
        Some of the methods of the Lua C API can raise errors. To get an initial idea on what these are, take a look at the Functions and Types section and pay attention to the third field of a function description (the one denoted by 'x' in the introduction).Dealing with the errors raised by these functions is tricky, not to say a nightmare. Also, the ridiculously-short documentation on this topic does not help. This post is dedicated to explain how these errors may be handled along with the advantages and disadvantages of each case.The Lua C API provides two modes of execution: protected and unprotected. When in protected mode, all errors caused by Lua are caught and reported to the caller in a controlled manner. When in unprotected mode, the errors just abort the execution of the calling process by default. So, one would think: just run the code in protected mode, right? Yeah, well... entering protected mode is nontrivial and it has its own particularities that make interaction with C++ problematic.Let's analyze error reporting by considering a simple example: the lua_gettable function.  The following Lua code would error out when executed:my_array = nilreturn my_array["test"]... which is obvious because indexing a non-table object is a mistake.  Now let's consider how this code would look like in C (modulo the my_array assignment):lua_getglobal(state, "my_array");lua_pushstring(state, "test");lua_gettable(state, -2);Simple, huh? Sure, but as it turns out, any of the API calls (not just lua_gettable) in this code can raise errors (I'll call them unsafe functions). What this means is that, unless you run the code with a lua_pcall wrapper, your program will simply exit in the face of a Lua error. Uh, your scripting language can "crash" your host program out of your control? Not nice.What would be nice is if each of the Lua C API unsafe functions reported an error (as a return value or whatever) and allowed the caller to decide what to do. Ideally, no state would change in the face of an error. Unfortunately, that is not the case but it is exactly what I would like to do. I am writing a C++ wrapper for Lua in the context of Kyua and fine granularity in error reporting means that automatic cleanup of resources managed by RAII is trivial.Let's analyze the options that we have to control errors caused within the Lua C API. I will explain in a later post the one I have chosen for the wrapper in Kyua (it has to be later because I'm not settled yet!).Install a panic handlerWhenever Lua code runs in an unprotected environment, one can use lua_atpanic to install a handler for errors.  The function provided by the user is executed when the error occurs and, if the panic function returns, the program exits.  To prevent exiting prematurely, one could opt for two mechanisms:Make the panic handler raise a C++ exception.  Sounds nice, right?  Well, it does not work.  The Lua library is generally built as a C binary which means that our panic handler will be called from within a C environment.  As a result, we cannot throw an exception from our C++ handler and expect things to work: the exception won't propagate correctly from a C++ context to a C context and then back to C++.  Most likely, the program will abort as soon as we leave the C++ world and enter C to unwind the stack.Use setjmp before the call to the unsafe Lua function and recover with longjmp from within the panic handler.  It turns out that this does work but with one important caveat: the stack is completely cleared before the call to the panic handler.  As a result, this prevents the requirement of "leave the stack unmodified on failure" as is desired of any function (report errors early before changing state).Run every single call in a protected environmentThis is doable but complex and not completely right: to do this, we need to write a C wrapper function for every unsafe API function and run it with lua_pcall. The overhead of this approach is significant: something as simple as a call to lua_gettable turns into several stack manipulation operations, a call to lua_pcall and then further stack modifications to adjust the results.Additionally, in order to prepare the call to lua_pcall, one has to use the multiple lua_push* functions to prepare the stack for the call. And, guess what, most of these functions that push values onto the stack can themselves fail. So... in order to prepare the environment for a safe call, we are already executing unsafe calls. (Granted, the errors in these case are only due to memory exhaustion... but still, the solution is not fully robust.)Lastly, note that we cannot use lua_cpcall because it does discard all return values of the executed function. Which means that we can't really wrap single Lua operations. (We could wrap a whole algorithm though.)Run the whole algorithm in a protected environmentThis defeats the whole purpose of the per-function wrapping.  We would need to provide a separate C/C++ function that runs all unsafe code and then call it by means of lua_pcall (or lua_cpcall) so that errors are captured and reported in a controlled manner.  This seems very efficient... albeit not transparent and will surely cause issues.Why is this problematic? Errors that happen inside the protected environment are managed by means of a longjmp. If the code wrapped by lua_pcall is a C++ function, it can instantiate objects. These objects have destructors. A longjmp outside of the function means that no destructors will run... so objects will leak memory, file descriptors, and anything you can imagine. Doom's day.Yes, I know Lua can be rebuilt to report internal errors by means of exceptions which would make this particular problem a non-issue... but this rules out any pre-packaged Lua binaries (the default is to use longjmp and henceforth what packaged binaries use). I do not want to embed Lua into my source tree.  I want to use Lua binary packages shipped with pretty much any OS (hey, including NetBSD!), which means that my code needs to be able to cope with Lua binaries that use setjmp/longjmp internally.Closing remarksI hope the above description makes any sense because I had to omit many, many details in order to make the post reasonably short. It could also be that there are other alternatives I have not considered, in which case I'd love to know them. Trying to find a solution to the above problem has already sucked several days of my free time, which translates in Kyua not seeing any further development until a solution is found!

        <a href="/2011/01/error-handling-in-lua.html">[Continue reading]</a>
      </p>
      
    </li>
  
    <li>
      <h2>
        <a class="post-link" href="/2011/01/understanding-setjmplongjmp.html">Understanding setjmp/longjmp</a>
      </h2>
      <span class="post-meta"><!-- From http://alanwsmith.com/jekyll-liquid-date-formatting-examples -->

January

2nd,
  
2011
at
03:22 
        &middot;
        <a href="/2011/01/understanding-setjmplongjmp.html#disqus_thread">
          <span class="disqus-comment-count"
                data-disqus-url="http://julio.meroh.net/2011/01/understanding-setjmplongjmp.html">Comments</span>
        </a>
      </span>
      
      <p>
        For a long time, I have been aware of the existence of the standard C functions setjmp and longjmp and that they can be used to simulate exceptions in C code. However, it wasn't until yesterday that I had to use them... and it was not trivial. The documentation for these functions tends to be confusing, and understanding them required looking for additional documents and a bit of experimentation. Let's see if this post helps in clarifying how these functions work.The first call to setjmp causes the process state (stack, CPU registers, etc.) to be saved in the provided jmp_buf structure and, then, a value of 0 to be returned. A subsequent call to longjmp with the same jmp_buf structure causes the process to go "back in time" to the state stored in said structure. The way this is useful is that, when going back in time, we tweak the return value of the setjmp call so we can actually run a second (or third or more) path as if nothing had happened.Let's see an example:#include &lt;setjmp.h&gt;#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;static jmp_buf buf;static voidmyfunc(void){   printf("In the function.n");   ... do some complex stuff ...   /* Go back in time: restore the execution context of setjmp    * but make the call return 1 instead of 0. */   longjmp(buf, 1);   printf("Not reached.n");}intmain(void) {   if (setjmp(buf) == 0) {       /* Try block. */       printf("Trying some function that may throw.n");       myfunc();       printf("Not reached.n");   } else {       /* Catch block. */       printf("Exception caught.n");   }   return EXIT_SUCCESS;}The example above shows the following when executed:Trying some function that may throw.In the function.Exception caught.So, what happened above? The code starts by calling setjmp to record the execution state and the call returns 0, which causes the first part of the conditional to run. You can think of this clause as the "try" part of an exception-based code. At some point during the execution of myfunc, an error is detected and is "thrown" by a call to longjmp and a value of 1. This causes the process to go back to the execution of setjmp but this time the call returns 1, which causes the second part of the conditional to run. You can think of this second clause as the "catch" part of an exception-based code.It is still unclear to me what the "execution context" stored in jmp_buf is: the documentation does not explain what kind of resources are correctly unwinded when the call to longjmp is made... which makes me wary of using this technique for exception-like handling purposes. Oh, and this is even less clear in the context of C++ code and, e.g. calls to destructors. Would be nice to expand the description of these APIs in the manual pages.

        <a href="/2011/01/understanding-setjmplongjmp.html">[Continue reading]</a>
      </p>
      
    </li>
  
    <li>
      <h2>
        <a class="post-link" href="/2011/01/happy-new-year.html">Happy new year!</a>
      </h2>
      <span class="post-meta"><!-- From http://alanwsmith.com/jekyll-liquid-date-formatting-examples -->

January

1st,
  
2011
at
14:37 
        &middot;
        <a href="/2011/01/happy-new-year.html#disqus_thread">
          <span class="disqus-comment-count"
                data-disqus-url="http://julio.meroh.net/2011/01/happy-new-year.html">Comments</span>
        </a>
      </span>
      
      <p>
        Dear readers,2011 is here so...Happy new year!I hope you all are having a nice holiday season and enjoyed the new year's eve celebration, should it be something special for you.My tentative resolutions for this year related to non-work and non-personal areas would be:First, to revive this blog. I have been lately posting more frequently than has been usual and it has been a pleasant task. I would like to recover the habit of blogging several times per week and, for that, I need topics! Keep'em coming! I already have some topics on the queue but they need a bit of research on my side first.Second, to bring Kyua to reality (i.e. to deprecate ATF). Work is continuing intensively and a preliminary release should be ready during Q1. This release will bring the much-needed replacement for atf-run.And third... well, haven't thought that much about resolutions ;-) We will see.

        <a href="/2011/01/happy-new-year.html">[Continue reading]</a>
      </p>
      
    </li>
  
    <li>
      <h2>
        <a class="post-link" href="/2010/12/using-raii-to-clean-up-temporary-values.html">Using RAII to clean up temporary values from a stack</a>
      </h2>
      <span class="post-meta"><!-- From http://alanwsmith.com/jekyll-liquid-date-formatting-examples -->

December

27th,
  
2010
at
04:06 
        &middot;
        <a href="/2010/12/using-raii-to-clean-up-temporary-values.html#disqus_thread">
          <span class="disqus-comment-count"
                data-disqus-url="http://julio.meroh.net/2010/12/using-raii-to-clean-up-temporary-values.html">Comments</span>
        </a>
      </span>
      
      <p>
        For the last couple of days, I have been playing around with the Lua C API and have been writing a thin wrapper library for C++. The main purpose of this auxiliary library is to ensure that global interpreter resources such as the global state or the execution stack are kept consistent in the presence of exceptions &mdash; and, in particular, that none of these are leaked due to programming mistakes when handling error codes.To illustrate this point, let's forget about Lua and consider a simpler case. Suppose we lost the ability to pass arguments and return values from functions in C++ and all we have is a stack that we pass around. With this in mind, we could implement a multiply function as follows:void multiply(std::stack& context) {    const int arg1 = context.top();    context.pop();    const int arg2 = context.top();    context.pop();    context.push(arg1 * arg2);}And we could call our function as this:std::stack context;context.push(5);context.push(6);multiply(context);const int result = s.top();s.pop();In fact, my friends, this is more-or-less what your C/C++ compiler is internally doing when converting code to assembly language. The way the stack is organized to perform calls is known as the calling conventions of an ABI (language/platform combination).Anyway, back to our point. One important property of such a stack-based system is that any function that deals with the stack must leave it in a consistent state: if the function pushes temporary values (read: local variables) into the stack, such temporary values must be gone upon return no matter how the function terminates. Otherwise, the caller will not find the stack as it expects, which will surely cause trouble at a later stage. The above example works just fine because our function is extremely simple and does not put anything on the stack.But things get messier when our functions can fail halfway through, and, in particular, if such failures are signaled by exceptions. In these cases, the function will abort abruptly and the function must take care to clean up any values that may still be left on the stack. Let's consider another example:void magic(std::stack& context) {    const int arg1 = context.top();    context.pop();    const int arg2 = context.top();    context.pop();    context.push(arg1 * arg2);    context.push(arg1 / arg2);    try {        ... do something with the two values on top ...        context.push(arg1 - arg2);        try {            ... do something with the three values on top ...        } catch (...) {            context.pop();  // arg1 - arg2            throw;        }        context.pop();    } catch (...) {        context.pop();  // arg1 / arg2        context.pop();  // arg1 * arg2        throw;    }    context.pop();    context.pop();}The above is a completely fictitious and useless function, but serves to illustrate the point.  magic() starts by pushing two values on the stack and then performs some computation that reads these two values.  It later pushes an additional value and does some more computations on the three temporary values that are on the top of the stack.The "problem" is that the computation code can throw an exception. If it does, we must sanitize the stack to remove the two or three values we have already pushed. Otherwise, the caller will receive the exception, it will assume nothing has happened, and will leak values on the stack (bad thing). To prevent this, we have added a couple of try/catch clauses to capture these possible exceptions and to clean up the already-pushed values before exiting the function. Unfortunately, this gets old very quickly: having to add try/catch statements surrounding every call is boring, ugly, and hard to read (remember that, potentially, any statement can throw an exception).  You can see this in the example above with the two nested try/catch blocks.To mitigate this situation, we can apply a RAII-like technique to make popping elements on errors completely transparent and automated. If we can make it transparent, writing the code is easier and reading it is trivial; if we can make it automated, we can be certain that our error paths (rarely tested!) correctly clean up any global state. In C++, destructors are deterministically executed whenever a variable goes out of scope, so we can use this to our advantage to clean up temporary values. Let's consider this class:class temp_stack {    std::stack& _stack;    int _pop_count;public:    temp_stack(std::stack& stack_) :        _stack(stack_), _pop_count(0) {}    ~temp_stack(void)    {        while (_pop_count-- > 0)            _stack.pop();    }    void push(int i)    {        _stack.push(i);        _pop_count++;    }};With this, we can rewrite our function as:void magic(std::stack& context) {    const int arg1 = context.top();    context.pop();    const int arg2 = context.top();    context.pop();    temp_stack temp(context);    temp_stack.push(arg1 * arg2);    temp_stack.push(arg1 / arg2);    ... do something with the two values on top ...    temp_stack.push(arg1 - arg2);    ... do something with the three values on top ...    // Yes, we can return now.  No need to do manual pop()s!}Simple, huh?  Our temp_stack function keeps track of how many elements have been pushed on the stack.  Whenever the function terminates, be it due to reaching the end of the body or due to an exception thrown anywhere, the temp_stack destructor will remove all elements previously registered from the stack.  This ensures that the function leaves the global state (the stack) as it was on entry &mdash; modulo the function parameters consumed as part of the calling conventions.So how does all this play together with Lua? Well, Lua maintains a stack to communicate parameters and return values between C and Lua. Such stack can be managed in a similar way with a RAII class, which makes it very easy to write native functions that deal with the stack and clean it up correctly in all cases.  I would like to show you some non-fictitious code right now, but it's not ready yet ;-)  But when it is, it will be part of Kyua.  Stay tuned!And, to conclude: to make C++ code robust, wrap objects that need manual clean up (pointers, file descriptors, etc.) with small wrapper classes that perform such clean up on destruction. These classes are typically fully inlined and contain a single member field, so they do not impose any performance penalty. But, on the contrary, your code can avoid the need of many try/catch blocks, which are tricky to get right and hard to validate.  (Unfortunately, this technique cannot be applied in, e.g. Java or Python, because the execution of the class destructors is completely non-deterministic and not guaranteed to happen whatsoever!)

        <a href="/2010/12/using-raii-to-clean-up-temporary-values.html">[Continue reading]</a>
      </p>
      
    </li>
  
    <li>
      <h2>
        <a class="post-link" href="/2010/12/dependency-injection-simple-class.html">Dependency injection: simple class constructors</a>
      </h2>
      <span class="post-meta"><!-- From http://alanwsmith.com/jekyll-liquid-date-formatting-examples -->

December

26th,
  
2010
at
05:41 
        &middot;
        <a href="/2010/12/dependency-injection-simple-class.html#disqus_thread">
          <span class="disqus-comment-count"
                data-disqus-url="http://julio.meroh.net/2010/12/dependency-injection-simple-class.html">Comments</span>
        </a>
      </span>
      
      <p>
        Following my previous post on dependency injection (DI for short), I wanted to show you today another example of code in which DI helps in making the code clearer and easier to validate. In this case, the person to blame for the original piece of code being criticized is me.The atffile module in ATF provides a class to represent the contents of Atffiles. An Atffile is, basically, a file containing a list of test programs to run and a list of properties associated to these test programs. Let's consider the original implementation of this module:class atffile {    strings_vector _test_programs;    strings_vector _properties;public:    atffile(const path& file)    {        std::ifstream input(file.c_str());        _test_programs = ... parse list from input ...;        _properties = ... parse list from input ...;    }    ... getters and other read-only methods ...};According to the object-oriented programming (OOP) principles we are taught over and over again, this seems like a reasonable design. An atffile object is entirely self-contained: if the constructor finishes successfully, we know that the new object matches exactly the representation of an Atffile on disk. The other methods in the class provide read-only access to the internal attributes, which ensures that the in-memory representation remains consistent.However, this design couples the initialization of an object with external dependencies, and that is bad for two main reasons: first, because it makes testing (very) difficult; and, second, because it makes an apparently simple action (constructing an object) a potentially expensive task (reading from an external resource).To illustrate the first point, let's consider a helper free-function that deals with an atffile object:std::stringget_property(const atffile& file, const std::string& name,             const std::string& defvalue){    const strings_vector& props = file.properties();    const strings_vector::const_iterator iter =        props.find(name);    if (iter == props.end())        return defvalue;    else        return *iter;}Now, how do we write unit-tests for this function? Note that, to execute this function, we need to pass in an atffile object. And to instantiate an atffile, we need to be able to read a Atffile from disk because the only constructor for the atffile class has this dependency on an external subsystem. So, summarizing, to test this innocent function, we need to create a file on disk with valid contents, we need to instantiate an atffile object pointing to this file, and only then we can pass it to the get_property function. At this point, our unit test smells like an integration test, and it actually is for no real reason. This will cause our test suite to be more fragile (the test for this auxiliary function depends on the parsing of a file) and slow.How can we improve the situation? Easy: decoupling the dependencies on external systems from the object initialization. Take a look at this rewritten atffile class:class atffile {    strings_vector _test_programs;    strings_vector _properties;public:    atffile(const strings_vector& test_programs_,            const strings_vector& properties_) :        _test_programs(test_programs_),        _properties(properties_)    {        assert(!_test_programs.empty());    }    static atffile    parse(const path& file)    {        std::ifstream input(file.c_str());        strings_vector test_programs_ =            ... parse list from input ...;        strings_vector properties_ =            ... parse list from input ...;        return atffile(test_programs_, properties_);    }    ... getters and other read-only methods ...};Note that this new design does not necessarily violate OOP principles: yes, we can now construct an object with fake values in it by passing them to the constructor, but that does not mean that such values can be inconsistent once the object is created. In this particular example, I have added an assertion in the constructor to reenforce a check performed by parse (that an atffile must list at least one test program).With this new design in mind, it is now trivial to test the get_property function shown above: constructing an auxiliary atffile object is easy, because we can inject values into the object to later pass it to get_property: no need to create a temporary file that has to be valid and later parsed by the atffile code. Our test now follows the true sense of a unit test, which is much faster, less fragile and "to-the-point". We can later write integration tests if we so desire. Additionally, we can also write tests for atffile member functions, and we can very easily reproduce corner cases for them by, for example, injecting bad data. The only place where we need to create temporary Atffiles is when we need to test the parse class method.So, to conclude: make your class constructors as simple as possible and, in particular, do not make your class constructors depend on external systems. If you find yourself opening resources or constructing other objects from within your constructor, you are doing it wrong (with very few exceptions).I have been using the above principle for the last ~2 years and the results are neat: I am much, much more confident on my code because I write lots of more accurate test cases and I can focalize dependencies on external resources on a small subset of functions. (Yes, Kyua uses this design pattern intensively!)

        <a href="/2010/12/dependency-injection-simple-class.html">[Continue reading]</a>
      </p>
      
    </li>
  
</ul>


<script id="dsq-count-scr" src="//jmmv.disqus.com/count.js" async></script>



      <div class="pagination">
        
          <span class="previous"><a
          href="/page27">&laquo;
          Newer posts</a></span>
        

        <!-- Disabled to not show a page count, which is meaningless.
        <span class="current">Page 28 of
        102</span>
        -->

        
          <span class="next"><a
          href="/page29">Older posts
          &raquo;</a></span>
        
      </div>
    </div>
    <div class="col-md-3 sidebar">
      <div class="row">
  <h2>Blog subscription</h2>

  <form class="feedburner form-horizontal"
        action="https://feedburner.google.com/fb/a/mailverify"
        method="post"
        target="popupwindow"
        onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=jmmv', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
    <div class="form-group">
      <div class="col-sm-10">
        <input type="text" name="email"
               placeholder="Enter your email" class="form-control"/>
      </div>
      <button type="submit" value="Subscribe" class="btn btn-default col-sm-2">
        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
      </button>
    </div>
    <input type="hidden" value="jmmv" name="uri"/>
    <input type="hidden" name="loc" value="en_US"/>
    <p>
      <small>Subscription by
      <a href="https://feedburner.google.com"
      target="_blank">FeedBurner</a></small>
    </p>
  </form>

  <p class="text-center"><a
  href="/feed.xml">RSS feed</a></p>

  <p class="text-center">
    <a href="https://twitter.com/jmmv"
    class="twitter-follow-button"
    data-show-count="false"
    data-size="large">Follow @jmmv</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  </p>
</div>

<div class="row archive">
  <h2>Archive</h2>

  

  <ul>
  <li>
    <a data-toggle="collapse" href="#archive-year-2017">2017</a> (6)
     
    <ul id="archive-year-2017" class="collapse">
     
      <li><a href="/2017/10">October 2017</a> (1)</li>
      <li><a href="/2017/08">August 2017</a> (1)</li>
      <li><a href="/2017/07">July 2017</a> (1)</li>
      <li><a href="/2017/02">February 2017</a> (3)</li>
      <li><a href="/2017">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2016">2016</a> (8)
     
    <ul id="archive-year-2016" class="collapse">
     
      <li><a href="/2016/09">September 2016</a> (1)</li>
      <li><a href="/2016/05">May 2016</a> (1)</li>
      <li><a href="/2016/04">April 2016</a> (1)</li>
      <li><a href="/2016/03">March 2016</a> (2)</li>
      <li><a href="/2016/02">February 2016</a> (1)</li>
      <li><a href="/2016/01">January 2016</a> (2)</li>
      <li><a href="/2016">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2015">2015</a> (17)
     
    <ul id="archive-year-2015" class="collapse">
     
      <li><a href="/2015/12">December 2015</a> (2)</li>
      <li><a href="/2015/10">October 2015</a> (2)</li>
      <li><a href="/2015/09">September 2015</a> (3)</li>
      <li><a href="/2015/06">June 2015</a> (2)</li>
      <li><a href="/2015/05">May 2015</a> (3)</li>
      <li><a href="/2015/04">April 2015</a> (1)</li>
      <li><a href="/2015/03">March 2015</a> (1)</li>
      <li><a href="/2015/02">February 2015</a> (3)</li>
      <li><a href="/2015">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2014">2014</a> (12)
     
    <ul id="archive-year-2014" class="collapse">
     
      <li><a href="/2014/11">November 2014</a> (2)</li>
      <li><a href="/2014/05">May 2014</a> (3)</li>
      <li><a href="/2014/03">March 2014</a> (1)</li>
      <li><a href="/2014/02">February 2014</a> (3)</li>
      <li><a href="/2014/01">January 2014</a> (3)</li>
      <li><a href="/2014">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2013">2013</a> (62)
     
    <ul id="archive-year-2013" class="collapse">
     
      <li><a href="/2013/12">December 2013</a> (7)</li>
      <li><a href="/2013/11">November 2013</a> (7)</li>
      <li><a href="/2013/10">October 2013</a> (7)</li>
      <li><a href="/2013/09">September 2013</a> (13)</li>
      <li><a href="/2013/08">August 2013</a> (9)</li>
      <li><a href="/2013/07">July 2013</a> (10)</li>
      <li><a href="/2013/06">June 2013</a> (9)</li>
      <li><a href="/2013">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2012">2012</a> (29)
     
    <ul id="archive-year-2012" class="collapse">
     
      <li><a href="/2012/10">October 2012</a> (1)</li>
      <li><a href="/2012/09">September 2012</a> (1)</li>
      <li><a href="/2012/08">August 2012</a> (3)</li>
      <li><a href="/2012/07">July 2012</a> (2)</li>
      <li><a href="/2012/06">June 2012</a> (2)</li>
      <li><a href="/2012/05">May 2012</a> (3)</li>
      <li><a href="/2012/04">April 2012</a> (1)</li>
      <li><a href="/2012/03">March 2012</a> (1)</li>
      <li><a href="/2012/02">February 2012</a> (10)</li>
      <li><a href="/2012/01">January 2012</a> (5)</li>
      <li><a href="/2012">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2011">2011</a> (60)
     
    <ul id="archive-year-2011" class="collapse">
     
      <li><a href="/2011/12">December 2011</a> (4)</li>
      <li><a href="/2011/11">November 2011</a> (4)</li>
      <li><a href="/2011/10">October 2011</a> (5)</li>
      <li><a href="/2011/09">September 2011</a> (11)</li>
      <li><a href="/2011/08">August 2011</a> (6)</li>
      <li><a href="/2011/07">July 2011</a> (4)</li>
      <li><a href="/2011/06">June 2011</a> (6)</li>
      <li><a href="/2011/05">May 2011</a> (6)</li>
      <li><a href="/2011/04">April 2011</a> (5)</li>
      <li><a href="/2011/03">March 2011</a> (2)</li>
      <li><a href="/2011/01">January 2011</a> (7)</li>
      <li><a href="/2011">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2010">2010</a> (26)
     
    <ul id="archive-year-2010" class="collapse">
     
      <li><a href="/2010/12">December 2010</a> (7)</li>
      <li><a href="/2010/09">September 2010</a> (1)</li>
      <li><a href="/2010/07">July 2010</a> (1)</li>
      <li><a href="/2010/06">June 2010</a> (2)</li>
      <li><a href="/2010/05">May 2010</a> (5)</li>
      <li><a href="/2010/04">April 2010</a> (5)</li>
      <li><a href="/2010/03">March 2010</a> (3)</li>
      <li><a href="/2010/01">January 2010</a> (2)</li>
      <li><a href="/2010">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2009">2009</a> (31)
     
    <ul id="archive-year-2009" class="collapse">
     
      <li><a href="/2009/10">October 2009</a> (1)</li>
      <li><a href="/2009/09">September 2009</a> (1)</li>
      <li><a href="/2009/08">August 2009</a> (3)</li>
      <li><a href="/2009/07">July 2009</a> (2)</li>
      <li><a href="/2009/06">June 2009</a> (4)</li>
      <li><a href="/2009/05">May 2009</a> (6)</li>
      <li><a href="/2009/04">April 2009</a> (2)</li>
      <li><a href="/2009/03">March 2009</a> (4)</li>
      <li><a href="/2009/01">January 2009</a> (8)</li>
      <li><a href="/2009">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2008">2008</a> (61)
     
    <ul id="archive-year-2008" class="collapse">
     
      <li><a href="/2008/12">December 2008</a> (1)</li>
      <li><a href="/2008/11">November 2008</a> (4)</li>
      <li><a href="/2008/10">October 2008</a> (6)</li>
      <li><a href="/2008/09">September 2008</a> (1)</li>
      <li><a href="/2008/08">August 2008</a> (6)</li>
      <li><a href="/2008/07">July 2008</a> (14)</li>
      <li><a href="/2008/06">June 2008</a> (3)</li>
      <li><a href="/2008/05">May 2008</a> (1)</li>
      <li><a href="/2008/04">April 2008</a> (3)</li>
      <li><a href="/2008/03">March 2008</a> (3)</li>
      <li><a href="/2008/02">February 2008</a> (9)</li>
      <li><a href="/2008/01">January 2008</a> (10)</li>
      <li><a href="/2008">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2007">2007</a> (85)
     
    <ul id="archive-year-2007" class="collapse">
     
      <li><a href="/2007/12">December 2007</a> (4)</li>
      <li><a href="/2007/11">November 2007</a> (7)</li>
      <li><a href="/2007/10">October 2007</a> (2)</li>
      <li><a href="/2007/09">September 2007</a> (8)</li>
      <li><a href="/2007/08">August 2007</a> (6)</li>
      <li><a href="/2007/07">July 2007</a> (15)</li>
      <li><a href="/2007/06">June 2007</a> (15)</li>
      <li><a href="/2007/05">May 2007</a> (4)</li>
      <li><a href="/2007/04">April 2007</a> (10)</li>
      <li><a href="/2007/03">March 2007</a> (7)</li>
      <li><a href="/2007/02">February 2007</a> (1)</li>
      <li><a href="/2007/01">January 2007</a> (6)</li>
      <li><a href="/2007">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2006">2006</a> (102)
     
    <ul id="archive-year-2006" class="collapse">
     
      <li><a href="/2006/12">December 2006</a> (4)</li>
      <li><a href="/2006/11">November 2006</a> (3)</li>
      <li><a href="/2006/10">October 2006</a> (7)</li>
      <li><a href="/2006/09">September 2006</a> (6)</li>
      <li><a href="/2006/08">August 2006</a> (13)</li>
      <li><a href="/2006/07">July 2006</a> (4)</li>
      <li><a href="/2006/06">June 2006</a> (13)</li>
      <li><a href="/2006/05">May 2006</a> (6)</li>
      <li><a href="/2006/04">April 2006</a> (9)</li>
      <li><a href="/2006/03">March 2006</a> (6)</li>
      <li><a href="/2006/02">February 2006</a> (13)</li>
      <li><a href="/2006/01">January 2006</a> (18)</li>
      <li><a href="/2006">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2005">2005</a> (126)
     
    <ul id="archive-year-2005" class="collapse">
     
      <li><a href="/2005/12">December 2005</a> (9)</li>
      <li><a href="/2005/11">November 2005</a> (7)</li>
      <li><a href="/2005/10">October 2005</a> (22)</li>
      <li><a href="/2005/09">September 2005</a> (10)</li>
      <li><a href="/2005/08">August 2005</a> (14)</li>
      <li><a href="/2005/07">July 2005</a> (5)</li>
      <li><a href="/2005/06">June 2005</a> (12)</li>
      <li><a href="/2005/05">May 2005</a> (6)</li>
      <li><a href="/2005/04">April 2005</a> (5)</li>
      <li><a href="/2005/03">March 2005</a> (12)</li>
      <li><a href="/2005/02">February 2005</a> (11)</li>
      <li><a href="/2005/01">January 2005</a> (13)</li>
      <li><a href="/2005">All year</a></li>
    </ul>
  </li>
  <li>
    <a data-toggle="collapse" href="#archive-year-2004">2004</a> (84)
     
    <ul id="archive-year-2004" class="collapse">
     
      <li><a href="/2004/12">December 2004</a> (9)</li>
      <li><a href="/2004/11">November 2004</a> (6)</li>
      <li><a href="/2004/10">October 2004</a> (11)</li>
      <li><a href="/2004/09">September 2004</a> (19)</li>
      <li><a href="/2004/07">July 2004</a> (29)</li>
      <li><a href="/2004/06">June 2004</a> (10)</li>
      <li><a href="/2004">All year</a></li>
    </ul>
  </li>
</ul>

</div>

    </div>
  </div>
</div>


    <div class="container">
  <footer>
    <p class="pull-right"><a href="#">Back to top</a></p>
    <p>Copyright 2016 Julio Merino</p>
  </footer>
</div>

<script src="/js/jquery-1.11.2.min.js">
</script>
<script
  src="/css/bootstrap.min.js">
</script>

<script src="/js/auto-toc-1.0.0.dist.js">
</script>

<script>
$("p:contains('NOTE: ')").addClass("callout callout-info");
$("p:contains('IMPORTANT: ')").addClass("callout callout-info");
$("p:contains('WARNING: ')").addClass("callout callout-warning");
$("p:contains('DANGER: ')").addClass("callout callout-danger");
</script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
  m.parentNode.insertBefore(a,m)})(window,document,'script',
  '//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63557333-1', 'auto');
  ga('send', 'pageview');
</script>


  </body>
</html>
